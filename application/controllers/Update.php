<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\105\120\x41\x54\110") or exit("\x4e\157\40\144\151\162\145\x63\x74\x20\x73\x63\x72\151\160\164\40\141\x63\x63\145\163\163\40\x61\154\x6c\x6f\167\145\144"); class Update extends CI_Controller { function __construct() { goto FoGLo; FoGLo: parent::__construct(); goto XA19U; IXAA5: $this->load->library("\145\x6e\x63\x72\171\x70\x74\151\157\156"); goto SeLA9; QZeMF: $this->load->dbforge(); goto BKEXV; BKEXV: $this->load->database(); goto IXAA5; XA19U: include APPPATH . "\x63\x6f\x6e\146\151\x67\57\144\141\164\141\142\141\163\x65\x2e\160\150\160"; goto QZeMF; SeLA9: } public function output_json($data, $encode = true) { goto hyWw1; Rss6U: qRNGK: goto gfb1O; hyWw1: if (!$encode) { goto qRNGK; } goto TOigq; TOigq: $data = json_encode($data); goto Rss6U; gfb1O: $this->output->set_content_type("\x61\x70\x70\x6c\151\143\x61\164\x69\x6f\156\x2f\x6a\x73\x6f\156")->set_output($data); goto DmtV6; DmtV6: } public function index() { goto xThO4; CP7rV: $this->load->view("\x69\156\163\164\x61\154\x6c\x2f\165\160\x64\141\164\x65"); goto nl2jX; nvUEl: $json = (array) $json; goto e97PA; e97PA: $data["\x6a\163\157\x6e"] = $json; goto Zisg4; LexvG: $json = json_decode($json); goto nvUEl; Zisg4: $this->load->view("\x69\x6e\x73\x74\x61\154\154\57\x68\x65\x61\144\x65\x72", $data); goto CP7rV; nl2jX: $this->load->view("\151\156\x73\164\x61\154\x6c\57\x66\x6f\157\x74\x65\x72"); goto SnM5U; xThO4: $json = file_get_contents("\x2e\57\141\x73\x73\145\x74\x73\x2f\141\x70\160\x2f\144\142\57\x64\x61\164\141\x62\x61\163\145\56\x6a\163\157\156"); goto LexvG; SnM5U: } function object_to_array($data) { goto A5wRF; TZVa9: return $data; goto QsDQd; ebmwj: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; gDLUo: } goto JD89X; F6VWD: $result = []; goto ebmwj; JD89X: aN00b: goto NXw7k; NXw7k: return $result; goto IYbsD; IYbsD: eILs4: goto TZVa9; A5wRF: if (!(is_array($data) || is_object($data))) { goto eILs4; } goto F6VWD; QsDQd: } public function checkDatabase() { goto RveRN; V8MIu: $json = json_decode($json); goto bfYUJ; bfYUJ: $json = (array) $json; goto JOaOv; Z8ghU: sort($full_tables); goto pWpJz; pWpJz: $create_tables = []; goto L_TGt; TZXjV: $full_tables = array_unique($full_tables); goto Z8ghU; SEl1_: $fields = []; goto O0QjI; MMokE: $json = file_get_contents("\x2e\57\141\163\x73\145\164\x73\57\x61\x70\x70\57\144\142\x2f\x64\141\x74\x61\x62\141\x73\x65\x2e\x6a\x73\157\x6e"); goto V8MIu; QUjIn: $data = ["\144\x62" => $fields, "\143\162\x65\141\x74\145" => $create_tables, "\155\x6f\144\x69\146\x79" => $edit_columns, "\x61\144\x64" => $add_columns, "\143\157\x75\156\164\163" => $counts, "\x6a\x73\157\156" => $json, "\x63\x75\162\162\x65\156\x74" => $currentDb]; goto T4b50; qFPpC: $tbl_ada = array_keys($fields); goto GBhe0; GBhe0: $full_tables = array_merge($tbl_baru, $tbl_ada); goto TZXjV; L_TGt: $add_columns = []; goto pDg5a; O0QjI: $currentDb = []; goto hBRM8; z_d19: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto QUjIn; XEeeT: $tabless = $this->db->list_tables(); goto SEl1_; JOaOv: $tbl_baru = array_keys($json); goto qFPpC; pDg5a: $edit_columns = []; goto PtzXB; xc2Fn: WvKtE: goto z_d19; hBRM8: foreach ($tabless as $table) { goto IzcuW; kTp7i: goto OWFxs; goto f0Dtw; tntWQ: $retval[$i] = new stdClass(); goto YYWJ_; X3_xc: $retval[$i]->extra = $query[$i]->extra; goto u1B90; he4O9: if (!($query[$i]->extra != '')) { goto AcIJF; } goto Bi9sU; r1114: $i = 0; goto ZzTUs; OvG8j: OWFxs: goto oo1Jp; ktLR9: goto y01hc; goto waQQI; oo1Jp: AcIJF: goto o9eiq; icMaw: $i++; goto ktLR9; u1B90: Rqn2x: goto icMaw; fkOKv: $sql = "\123\105\x4c\105\x43\x54\40\140\x63\157\154\165\155\x6e\x5f\x6e\141\155\145\140\x2c\40\140\x6e\165\x6d\145\x72\151\x63\x5f\160\x72\x65\x63\x69\163\151\x6f\156\140\54\40\140\x65\x78\164\x72\141\x60\x2c\x20\x60\151\163\137\156\x75\x6c\154\141\142\x6c\x65\140" . "\x20\106\x52\117\x4d\40\140\151\156\x66\x6f\x72\x6d\141\x74\151\x6f\156\137\163\x63\x68\x65\x6d\x61\x60\56\140\143\x6f\x6c\x75\155\x6e\163\140\x20\127\x48\x45\122\x45\40\164\141\142\x6c\x65\137\163\x63\150\x65\155\x61\40\x3d\x20\42" . $this->db->database . "\42\x20\101\116\x44\x20\164\141\x62\154\145\137\x6e\141\155\145\40\x3d\x20\x22" . $table . "\x22"; goto x2aDg; AaeKS: $datafld[$i]->extra = $query[$i]->extra; goto kTp7i; IzcuW: $datafld = $this->db->field_data($table); goto fkOKv; mZhQ9: $currentDb[$table] = $retval; goto WRN11; f0Dtw: SHaoq: goto xmJVr; waQQI: S1nLl: goto mZhQ9; Fe9Tp: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto X2dZd; } goto he4O9; vQDw9: y01hc: goto BMpzE; Bi9sU: if ($query[$i]->extra == "\141\x75\x74\157\137\151\x6e\143\162\x65\x6d\x65\156\x74") { goto SHaoq; } goto AaeKS; BMpzE: if (!($i < $c)) { goto S1nLl; } goto Fe9Tp; o9eiq: X2dZd: goto tntWQ; YoCJ2: $query = $query->result_object(); goto LH571; ZzTUs: $c = count($query); goto vQDw9; x2aDg: if (!(($query = $this->db->query($sql)) === FALSE)) { goto gW3Ci; } goto M9uQc; YYWJ_: $retval[$i]->name = $query[$i]->column_name; goto X3_xc; M9uQc: $currentDb = FALSE; goto BS2SC; WRN11: $fields[$table] = $datafld; goto u1PLH; u1PLH: nSK7g: goto zTvOi; LH571: $retval = array(); goto r1114; BS2SC: gW3Ci: goto YoCJ2; xmJVr: $datafld[$i]->auto_increment = true; goto OvG8j; zTvOi: } goto Lb0u4; io7Pt: $this->db->db_debug = FALSE; goto XEeeT; RveRN: $db_debug = $this->db->db_debug; goto io7Pt; Lb0u4: V9iao: goto MMokE; T4b50: $this->output_json($data); goto RsAfN; PtzXB: foreach ($full_tables as $table) { goto KzHcT; qrNh7: Mib3M: goto HH3eJ; DSx1t: goto r7e56; goto qrNh7; HH3eJ: if (!isset($json[$table])) { goto EOAB4; } goto u0o_1; gBqeT: EEGhg: goto QY9uc; QY9uc: EOAB4: goto xrdjs; r035X: $create_tables[$table] = $json[$table]; goto DSx1t; KzHcT: if ($this->db->table_exists($table)) { goto Mib3M; } goto r035X; eyN_M: hC4d4: goto axbBa; u0o_1: foreach ($json[$table] as $jtbl) { goto blKGo; Btf2W: oeopL: goto XnuEy; Hd5MS: ix_Zc: goto JtCEO; S4vCu: foreach ($fields[$table] as $ftbl) { goto MfdQD; tZ91I: $edit_columns[$table][] = $jtbl; goto Kckv8; qvm4k: j3R0p: goto o5TiM; Kckv8: buRrx: goto qvm4k; iR030: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto buRrx; } goto tZ91I; MfdQD: if (!($jtbl->name == $ftbl->name)) { goto j3R0p; } goto iR030; o5TiM: ffYG5: goto Wgozk; Wgozk: } goto Btf2W; rj_jr: $add_columns[$table][] = $jtbl; goto Qh3rw; lwoE3: VDyjx: goto S4vCu; blKGo: if ($this->db->field_exists($jtbl->name, $table)) { goto VDyjx; } goto rj_jr; XnuEy: pM3SM: goto Hd5MS; Qh3rw: goto pM3SM; goto lwoE3; JtCEO: } goto gBqeT; xrdjs: r7e56: goto eyN_M; axbBa: } goto xc2Fn; RsAfN: } public function updateDatabase() { goto PVjf9; lnV7Q: foreach ($full_tables as $table) { goto xg2Z_; qibci: l5jBL: goto k6HIC; Edp56: if (!isset($json[$table])) { goto r0h0O; } goto R5plj; xg2Z_: if ($this->db->table_exists($table)) { goto kjz1D; } goto Edp56; Hoo0D: Jz0LY: goto hY2jk; hY2jk: gqC4K: goto E_zN_; uEJ2x: $this->dbforge->create_table($table, TRUE); goto AvJxf; zkITL: goto Jz0LY; goto j4fFx; xU_Ue: if (!isset($json[$table])) { goto yvTu9; } goto wviRk; YqYeM: Gf2MA: goto uEJ2x; T8iJZ: r0h0O: goto zkITL; R5plj: foreach ($json[$table] as $tbl => $jtbl) { goto aMr3h; YHMMg: if (!($jtbl->primary_key == 1)) { goto p61UO; } goto c4Ubo; ZMhyr: HTZak: goto lWm5i; XiU8B: p61UO: goto ZMhyr; c4Ubo: $this->dbforge->add_key($jtbl->name, true); goto XiU8B; aMr3h: $field = [$jtbl->name => ["\164\171\x70\145" => $jtbl->type, "\143\157\x6e\x73\164\162\x61\x69\x6e\x74" => $jtbl->max_length, "\156\165\x6c\154" => $jtbl->primary_key == 0]]; goto vEjWp; vEjWp: $this->dbforge->add_field($field); goto YHMMg; lWm5i: } goto YqYeM; j4fFx: kjz1D: goto xU_Ue; AvJxf: $this->db->query("\101\114\x54\105\x52\x20\124\101\102\x4c\x45\x20\x20\x60" . $table . "\140\40\105\116\107\x49\116\x45\x20\75\x20\x49\x6e\156\x6f\x44\102"); goto T8iJZ; k6HIC: yvTu9: goto Hoo0D; wviRk: foreach ($json[$table] as $jtbl) { goto qMH6a; VJiH8: piA3T: goto xmiOQ; aGzkv: goto vfS8N; goto EAAE8; QoueG: $this->dbforge->add_key($jtbl->name, true); goto cdGck; cdGck: $this->dbforge->add_column($table, $field); goto aGzkv; TO6iw: if ($jtbl->primary_key == 0) { goto Bsf6j; } goto a86NX; xmiOQ: Kvweu: goto Q5bid; a86NX: $field = array($jtbl->name => array("\164\171\160\x65" => $jtbl->type, "\x63\157\156\x73\164\x72\141\151\x6e\164" => $jtbl->max_length, "\156\x75\154\154" => false)); goto QoueG; qMH6a: if ($this->db->field_exists($jtbl->name, $table)) { goto YSCky; } goto TO6iw; caJqq: vfS8N: goto blof0; JpyuR: $field = array($jtbl->name => array("\x74\171\x70\145" => $jtbl->type, "\x63\157\156\x73\164\162\x61\151\x6e\x74" => $jtbl->max_length, "\x64\x65\x66\141\x75\x6c\164" => $jtbl->default)); goto spoJ7; omHNL: YSCky: goto DcCjD; blof0: goto Kvweu; goto omHNL; EAAE8: Bsf6j: goto JpyuR; spoJ7: $this->dbforge->add_column($table, $field); goto caJqq; DcCjD: foreach ($fields[$table] as $ftbl) { goto I2PZ2; rJ_7Z: yjbCZ: goto qJlz2; HMmcc: M2aZ6: goto LYxPU; LYxPU: QkrbD: goto c7r_X; I2PZ2: if (!($jtbl->name == $ftbl->name)) { goto M2aZ6; } goto Nu2be; nax8e: if ($jtbl->auto_increment == true) { goto X9rph; } goto VJKwv; p2Ve2: goto B53e6; goto R4jey; U9HNb: $this->dbforge->modify_column($table, $field); goto w2Xq1; RQzyN: B53e6: goto fKmJV; ykARn: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto MiLSd; Nu2be: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto lCtgJ; } goto Zqsdc; e3_NP: HaGjr: goto ykARn; fKmJV: $this->dbforge->add_key($jtbl->name, true); goto U9HNb; R4jey: X9rph: goto LKzl_; LKzl_: $field = array($jtbl->name => array("\164\171\160\145" => $jtbl->type, "\143\x6f\x6e\x73\x74\x72\x61\151\156\164" => $jtbl->max_length, "\x6e\x75\154\x6c" => false, "\x61\165\164\x6f\137\151\156\143\162\x65\x6d\145\x6e\x74" => true)); goto RQzyN; ekCF9: wN60Q: goto Vn1oB; w2Xq1: goto wN60Q; goto rJ_7Z; Zqsdc: if ($jtbl->primary_key == 0) { goto yjbCZ; } goto nax8e; K4aHm: u0VPS: goto e1a6V; VJKwv: $field = array($jtbl->name => array("\164\x79\x70\145" => $jtbl->type, "\143\157\x6e\163\164\x72\141\x69\156\x74" => $jtbl->max_length, "\x6e\x75\154\154" => false)); goto p2Ve2; Vn1oB: lCtgJ: goto HMmcc; ypc2m: $field = array($jtbl->name => array("\164\x79\160\x65" => $jtbl->type, "\x63\x6f\156\x73\x74\x72\x61\151\156\164" => $jtbl->max_length, "\x64\x65\146\x61\x75\154\164" => $jtbl->default)); goto mlbNn; MiLSd: $field = array($jtbl->name . "\x20\x64\x61\x74\145\164\x69\155\145\40\144\145\x66\x61\165\154\164\x20\x63\x75\x72\162\x65\156\x74\x5f\x74\x69\155\145\x73\x74\x61\x6d\160" . $onUpdate); goto K4aHm; mlbNn: goto u0VPS; goto e3_NP; qJlz2: if ($jtbl->default == "\x43\x55\122\122\x45\x4e\124\137\x54\111\115\105\x53\124\x41\x4d\120") { goto HaGjr; } goto ypc2m; e1a6V: $this->dbforge->modify_column($table, $field); goto ekCF9; c7r_X: } goto VJiH8; Q5bid: SnJSD: goto sr91U; sr91U: } goto qibci; E_zN_: } goto ahrlh; Bm7h3: $json = json_decode($json); goto ff7Py; oxLo2: $full_tables = array_merge($tbl_baru, $tbl_ada); goto NAn1A; vh9xU: $tbl_ada = array_keys($fields); goto oxLo2; vrMrf: sort($full_tables); goto lnV7Q; MV1Jk: $fields = []; goto ws433; dSrl1: echo true; goto fhBI0; ahrlh: G50_x: goto dSrl1; PVjf9: $tabless = $this->db->list_tables(); goto MV1Jk; ws433: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); M9v7B: } goto oZgQh; oZgQh: TokDg: goto PiFpX; BLS3F: $tbl_baru = array_keys($json); goto vh9xU; NAn1A: $full_tables = array_unique($full_tables); goto vrMrf; PiFpX: $json = file_get_contents("\x2e\x2f\141\163\x73\145\x74\163\x2f\141\160\x70\x2f\x64\142\57\x64\x61\164\141\x62\141\163\x65\x2e\x6a\163\x6f\156"); goto Bm7h3; ff7Py: $json = (array) $json; goto BLS3F; fhBI0: } public function checkDb() { goto w6eoP; A8NjT: $fields = []; goto HbMiP; uSw_G: cvKXa: goto pXAx1; KrLXM: $json = json_decode($json); goto AD_JM; E9kPG: $this->db->db_debug = $db_debug; goto L5Kh7; KT0Kj: $tbl_ada = array_keys($fields); goto ot9Xe; w6eoP: $db_debug = $this->db->db_debug; goto S29be; x1l3s: $tabless = $this->db->list_tables(); goto A8NjT; LWZKz: $script_create_table = []; goto D9Lrd; S29be: $this->db->db_debug = FALSE; goto x1l3s; AD_JM: $json = (array) $json; goto HMbtM; C8CAi: foreach ($full_tables as $table) { goto tdgZL; AnrUm: if (!(count($add_column) > 0)) { goto bJNd4; } goto ZuuL7; qHKlB: goto sXuGb; goto yB8il; tu70l: foreach ($json[$table]->columns as $jtbl) { goto SHkgG; ZPaqC: S8crC: goto URgl9; DLf0t: ZDCK6: goto VhQT6; URgl9: JqCq_: goto UDvmD; UDvmD: $nullable = $jtbl->nullable == "\116\x4f" ? "\40\116\117\x54\x20\x4e\x55\x4c\114" : ''; goto venuB; gePt0: TvtGR: goto xZkbm; pTUhs: GEadS: goto zrU4H; PQMYR: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto QOPXY; xy2sH: if ($jtbl->max_length == null) { goto gsqYM; } goto KdcTX; VhQT6: hMBR4: goto UpBhI; rWVMv: $length = ''; goto Yo50W; Pg6go: $length = ''; goto pdUSA; KdcTX: if ($jtbl->type != "\x6c\157\x6e\147\164\x65\170\164" && $jtbl->type != "\x6d\x65\144\151\x75\155\x74\x65\170\x74" && $jtbl->type != "\x74\145\170\164") { goto GEadS; } goto rWVMv; lI9u4: goto S8crC; goto NpeYI; venuB: $default = $jtbl->default == null ? '' : "\x20\x44\x45\x46\x41\125\x4c\x54\x20" . $jtbl->default; goto PQMYR; SHkgG: if ($this->db->field_exists($jtbl->name, $table)) { goto TvtGR; } goto aGOjk; Yo50W: goto JqCq_; goto WEfuD; QOPXY: if (!(strtoupper($extra) == "\40\x41\x55\124\x4f\137\x49\116\x43\x52\x45\115\105\116\x54")) { goto tDtAa; } goto aO62Z; xZkbm: foreach ($fields[$table]->columns as $ftbl) { goto vYsRa; SCLx_: $edit_columns[$table][$jtbl->name]["\x63\157\154\x5f\164\x79\160\145"] = $jtbl->col_type; goto fZurV; j7iyF: if (!($jtbl->extra != null)) { goto F3ekO; } goto tWABW; XVkc6: $edit_columns[$table][$jtbl->name]["\160\162\151\x6d\x61\x72\x79"] = $jtbl->primary; goto V2qXZ; Sro1y: if (!($jtbl->col_type != $ftbl->col_type)) { goto sDSfE; } goto SCLx_; GEw3V: goto WVSbU; goto qtaxS; Nj4SE: FDcab: goto NV1hk; urUpb: if (!($jtbl->default != null)) { goto To326; } goto OBA4r; V2qXZ: if (strtolower($jtbl->primary) == "\160\162\151") { goto RovZD; } goto DNITd; tWABW: $jtbl->extra = str_replace("\50\x29", '', $jtbl->extra); goto Jc0Tl; Mc7Zl: $edit_columns[$table][$jtbl->name]["\x65\170\x74\162\141"] = $jtbl->extra; goto oSFk0; luD8z: array_push($modif_column, "\115\x4f\104\111\106\x59\x20\x60" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto DcLvK; ld3hT: $ftbl->extra = str_replace("\x28\51", '', $ftbl->extra); goto er6_N; a6Yta: if (!($jtbl->default != $ftbl->default)) { goto d8xGD; } goto LZ8Dm; lWxE_: $jtbl->default = strtoupper($jtbl->default); goto sriWG; fZurV: sDSfE: goto fOjor; HdBvR: uzQ4O: goto a6Yta; Wk59C: RovZD: goto KwZVm; Jc0Tl: $jtbl->extra = strtoupper($jtbl->extra); goto ZraQc; NpgqV: if (!($ftbl->extra != null)) { goto lBWzN; } goto ld3hT; fNbmw: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto vwahr; dpueT: $ftbl->default = str_replace("\50\51", '', $ftbl->default); goto Tkojl; NV1hk: PkfSw: goto Fne7t; hbRJq: IyCYX: goto gubNN; oSFk0: fUgBo: goto qWDZ3; eYgkI: if (!($ftbl->default != null)) { goto uzQ4O; } goto dpueT; qWDZ3: if (!($jtbl->comment != $ftbl->comment)) { goto IyCYX; } goto RLFF5; KwZVm: array_push($modif_column, "\x41\104\104\x20\120\122\x49\x4d\101\x52\131\x20\113\105\x59\x20\x28\140" . $jtbl->name . "\x60\x29"); goto GEw3V; DvH7a: $edit_columns[$table][$jtbl->name]["\x6e\165\x6c\154\x61\142\x6c\x65"] = $jtbl->nullable; goto NDJ4g; zB47k: d8xGD: goto j7iyF; QEM14: $nullable = $jtbl->nullable == "\116\x4f" ? "\x20\x4e\x4f\124\x20\116\125\114\114" : ''; goto b270E; Tkojl: $ftbl->default = strtoupper($ftbl->default); goto HdBvR; RLFF5: $edit_columns[$table][$jtbl->name]["\143\x6f\155\x6d\145\156\x74"] = $jtbl->comment; goto hbRJq; er6_N: $ftbl->extra = strtoupper($ftbl->extra); goto Hfzxv; Hfzxv: lBWzN: goto PDGv1; sriWG: To326: goto eYgkI; qtaxS: Um9YW: goto FVFmb; gubNN: if (!($jtbl->primary != $ftbl->primary)) { goto hmkTc; } goto XVkc6; LZ8Dm: $edit_columns[$table][$jtbl->name]["\x64\x65\146\141\x75\x6c\164"] = $jtbl->default; goto zB47k; ZraQc: F3ekO: goto NpgqV; DcLvK: kd0BX: goto Nj4SE; dxxIe: hmkTc: goto oDONw; oDONw: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto kd0BX; } goto QEM14; vYsRa: if (!($jtbl->name == $ftbl->name)) { goto FDcab; } goto Sro1y; NDJ4g: GdWMu: goto urUpb; fOjor: if (!($jtbl->nullable != $ftbl->nullable)) { goto GdWMu; } goto DvH7a; OBA4r: $jtbl->default = str_replace("\x28\x29", '', $jtbl->default); goto lWxE_; DNITd: if (strtolower($jtbl->primary) == "\x75\156\151") { goto Um9YW; } goto XGV8i; XGV8i: goto WVSbU; goto Wk59C; FVFmb: array_push($modif_column, "\101\x44\104\40\x55\116\x49\121\x55\x45\40\113\x45\x59\x20\x60" . $jtbl->name . "\140\40\x28\x60" . $jtbl->name . "\x60\51"); goto HoG1C; b270E: $default = $jtbl->default == null ? '' : "\40\104\105\106\x41\125\x4c\x54\x20" . $jtbl->default; goto fNbmw; vwahr: $comment = $jtbl->comment == '' ? '' : "\40\x43\117\x4d\115\x45\x4e\124\x20\47" . $jtbl->comment . "\47"; goto luD8z; PDGv1: if (!($jtbl->extra != $ftbl->extra)) { goto fUgBo; } goto Mc7Zl; HoG1C: WVSbU: goto dxxIe; Fne7t: } goto DLf0t; zrU4H: if ($jtbl->type == "\x69\x6e\164") { goto cIYZs; } goto A3gyV; aGOjk: $add_columns[$table][] = $jtbl; goto xy2sH; WEfuD: gsqYM: goto Pg6go; JhjQE: $length = "\x28" . ($jtbl->max_length + 1) . "\51"; goto ZPaqC; A3gyV: $length = "\50" . $jtbl->max_length . "\51"; goto lI9u4; pdUSA: goto JqCq_; goto pTUhs; aO62Z: $extra .= "\x20\120\122\111\x4d\101\x52\x59\40\x4b\105\x59"; goto BCysZ; NpeYI: cIYZs: goto JhjQE; BCysZ: tDtAa: goto CaVig; gto2Y: array_push($add_column, "\x41\x44\x44\40\140" . $jtbl->name . "\x60\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto gePt0; CaVig: $comment = $jtbl->comment == '' ? '' : "\x20\x43\x4f\x4d\115\x45\x4e\124\x20\x27" . $jtbl->comment . "\x27"; goto gto2Y; UpBhI: } goto o1Wcd; oKFJH: if (!isset($json[$table])) { goto WeLLA; } goto TWee3; poXEH: $modif_column = []; goto tu70l; NPqV0: foreach ($json[$table]->columns as $column) { goto UxLBy; Dk8j7: $comment = $column->comment == '' ? '' : "\40\x43\x4f\x4d\x4d\x45\116\x54\40\47" . $column->comment . "\47"; goto J3rAn; Z69Gc: n32ur: goto h_XCn; IJXhM: goto YmZ3z; goto WB7Iq; V8hFe: $nullable = $column->nullable == "\116\x4f" ? "\40\116\117\124\x20\x4e\125\x4c\x4c" : ''; goto WDGb3; UxLBy: if ($column->max_length == null) { goto yhYUT; } goto rAj2m; h_XCn: $length = "\x28" . ($column->max_length + 1) . "\51"; goto YlMQh; oW70w: if ($column->type == "\151\156\x74") { goto n32ur; } goto xeZPw; WB7Iq: vuGyh: goto oW70w; WZYjo: $extra = $column->extra == '' ? '' : "\40" . strtoupper($column->extra); goto Dk8j7; WDGb3: $default = $column->default == null ? '' : "\40\104\105\x46\x41\125\114\x54\40" . $column->default; goto WZYjo; WkMoj: goto YmZ3z; goto RTKw4; oOtPF: $length = ''; goto IJXhM; lmhf9: goto XbEJe; goto Z69Gc; YlMQh: XbEJe: goto vsCxv; J3rAn: $script .= "\x60" . $column->name . "\x60\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\x20"; goto nTQse; n4IWV: I9czS: goto AqtBp; Ro3nP: $length = ''; goto WkMoj; rAj2m: if ($column->type != "\154\x6f\156\x67\164\145\x78\x74" && $column->type != "\x6d\145\144\151\x75\x6d\164\145\170\164" && $column->type != "\164\145\170\x74") { goto vuGyh; } goto Ro3nP; RTKw4: yhYUT: goto oOtPF; xeZPw: $length = "\x28" . $column->max_length . "\51"; goto lmhf9; vsCxv: YmZ3z: goto V8hFe; nTQse: $pri .= $column->primary != '' ? "\120\122\111\x4d\101\122\x59\40\113\105\x59\40\x28\x60" . $column->name . "\140\51" : ''; goto n4IWV; AqtBp: } goto STLvj; rgg12: if (!(count($modif_column) > 0)) { goto HvGi2; } goto HoBav; PeVEE: $pri = ''; goto NPqV0; WbUnE: $script_create_table[$table] = $script; goto x3odN; UkC2X: WeLLA: goto qHKlB; szMDW: v2aB9: goto M1xvL; tdgZL: if (!$this->db->table_exists($table)) { goto OxgC6; } goto oKFJH; STLvj: tnauz: goto tsT4F; ZuuL7: $script_create_column[$table] = "\x41\x4c\x54\105\122\x20\124\101\x42\x4c\105\40\x60" . $table . "\x60\40" . implode("\x2c\40", $add_column) . "\73"; goto d5Ny9; kXX9t: $create_tables[] = $json[$table]; goto PA4gC; tsT4F: $script .= $pri . "\x29\40\105\116\x47\111\116\105\75\x49\156\156\157\x44\102\x20\104\105\x46\x41\125\x4c\x54\x20\x43\x48\x41\122\x53\105\x54\x3d\x75\x74\x66\x38\155\142\64\x3b"; goto WbUnE; TWee3: $add_column = []; goto poXEH; yB8il: OxgC6: goto kXX9t; d5Ny9: bJNd4: goto rgg12; PA4gC: $script = "\103\122\x45\101\x54\x45\40\x54\101\x42\x4c\105\40\140" . $table . "\x60\x20\50"; goto PeVEE; sa2L9: HvGi2: goto UkC2X; o1Wcd: IY42o: goto AnrUm; HoBav: $script_edit_column[$table] = "\x41\114\124\105\122\40\124\101\102\114\x45\40\x60" . $table . "\x60\x20" . implode("\54\40", $modif_column) . "\73"; goto sa2L9; x3odN: sXuGb: goto szMDW; M1xvL: } goto oMPF7; HbMiP: foreach ($tabless as $table) { goto mp7IR; sroYR: $retval[$i]->primary = $query[$i]->column_key; goto Gwx1K; u6e5V: $retval[$i]->default = $query[$i]->column_default; goto wDoko; Rrpyp: $retval = array(); goto Mj4l2; Z8hRc: vnOcE: goto A2Qiq; Gwx1K: IaiEN: goto TCrs7; RTd3h: $fields = FALSE; goto J5ZyL; gTmI3: $query = $query->result_object(); goto Rrpyp; mQZD7: $retval[$i]->extra = $query[$i]->extra; goto S2GwF; wDoko: $retval[$i]->comment = $query[$i]->column_comment; goto mQZD7; TCrs7: $i++; goto NQuEp; mp7IR: $sql = "\x53\105\x4c\x45\x43\x54\x20\x60\143\x6f\154\x75\155\156\x5f\156\x61\155\145\140\x2c\x20\140\143\157\x6c\165\x6d\156\137\x74\171\x70\x65\x60\x2c\x20\x60\143\157\154\154\x61\164\151\157\156\x5f\x6e\141\x6d\x65\140\x2c\x20\140\x64\141\x74\141\137\164\171\160\x65\140\54\40\140\x63\x68\141\162\x61\x63\164\x65\162\137\x6d\141\170\x69\x6d\x75\155\x5f\154\x65\x6e\x67\164\150\x60\x2c\x20\140\156\x75\155\145\x72\151\143\137\160\162\x65\143\x69\163\151\x6f\x6e\x60\54" . "\x20\140\143\157\154\x75\155\x6e\137\144\145\x66\x61\x75\x6c\x74\x60\54\40\x60\x63\x6f\x6c\x75\x6d\156\x5f\x6b\145\x79\x60\x2c\x20\140\x63\157\x6c\x75\x6d\x6e\x5f\143\157\155\x6d\145\156\x74\140\x2c\x20\x60\145\x78\164\x72\141\140\x2c\x20\x60\151\x73\137\156\x75\x6c\x6c\x61\x62\x6c\x65\140\15\xa\11\11\11\x46\122\x4f\x4d\x20\140\x69\156\x66\157\162\x6d\x61\x74\x69\x6f\x6e\x5f\x73\143\x68\145\x6d\141\x60\x2e\x60\x63\x6f\x6c\x75\155\x6e\x73\140\x20\x57\110\105\122\105\40\164\x61\142\154\x65\137\x73\143\x68\145\155\x61\x20\75\x20\x22" . $this->db->database . "\x22\40\101\116\104\40\x74\x61\x62\154\x65\137\x6e\x61\155\145\40\x3d\x20\x22" . $table . "\42"; goto R9ejH; Ylb_m: $retval[$i]->collation = $query[$i]->collation_name; goto UQCW4; ajgux: $retval[$i]->type = $query[$i]->data_type; goto Ylb_m; S2GwF: $retval[$i]->nullable = $query[$i]->is_nullable; goto sroYR; UQCW4: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto u6e5V; x0qox: $retval[$i]->name = $query[$i]->column_name; goto zmBYo; CK7sh: $c = count($query); goto XrVTy; Mj4l2: $i = 0; goto CK7sh; daoQN: $fields[$table] = (object) ["\x74\141\x62\x6c\145\x5f\156\x61\155\145" => $table, "\143\157\x6c\165\155\156\163" => $retval]; goto Z8hRc; Kg5AG: if (!($i < $c)) { goto sqRzK; } goto cFG19; cFG19: $retval[$i] = new stdClass(); goto x0qox; J5ZyL: TCWd7: goto gTmI3; ODSYq: sqRzK: goto daoQN; R9ejH: if (!(($query = $this->db->query($sql)) === FALSE)) { goto TCWd7; } goto RTd3h; NQuEp: goto eryPl; goto ODSYq; zmBYo: $retval[$i]->col_type = $query[$i]->column_type; goto ajgux; XrVTy: eryPl: goto Kg5AG; A2Qiq: } goto uSw_G; X0cBP: $this->output_json($data); goto ipD1o; PjMcD: $create_tables = []; goto LWZKz; q2iGa: $full_tables = array_unique($full_tables); goto BgQ6j; CkIgE: $script_create_column = []; goto mcBmM; oMPF7: ZyWMZ: goto E9kPG; HMbtM: $tbl_seharusnya = array_keys($json); goto KT0Kj; mcBmM: $edit_columns = []; goto yaKhE; BgQ6j: sort($full_tables); goto PjMcD; pXAx1: $json = file_get_contents("\x2e\57\141\x73\163\145\164\x73\57\141\x70\x70\x2f\x64\142\x2f\144\x61\x74\141\x62\141\163\145\56\152\163\x6f\x6e"); goto KrLXM; ot9Xe: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto q2iGa; yaKhE: $script_edit_column = []; goto C8CAi; D9Lrd: $add_columns = []; goto CkIgE; L5Kh7: $data = ["\x66\151\145\154\144\163" => $fields, "\x63\x72\145\x61\164\145\x5f\164\x61\x62\154\145\163" => $create_tables, "\143\157\x75\x6e\164\x5f\x74\x62\154" => count($create_tables), "\x61\x64\x64\x5f\143\157\154\x75\155\x6e\163\x5f\x74\x6f\137\164\141\x62\154\145" => $add_columns, "\x63\157\x75\156\x74\137\x63\157\154" => count($add_columns), "\x65\144\x69\164\137\143\157\x6c\165\155\x6e\x73" => $edit_columns, "\143\x6f\165\x6e\x74\137\x6d\157\144" => count($edit_columns), "\x61\x64\x64\x5f\164\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\144\x64\137\143\157\154" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\x64\137\143\x6f\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto X0cBP; ipD1o: } public function createTable() { goto d7z0E; qeCRp: $scripts = json_decode($this->encryption->decrypt($scripts)); goto vU2Pp; XfKUa: $data["\155\145\163\163\141\147\x65"] = "\125\x70\144\141\164\x65\x20\153\157\x6c\157\155"; goto dfZ98; FN8gd: foreach ($scripts as $script) { $queries .= $script; WjOkp: } goto oLWbQ; d7z0E: $scripts = $this->input->post("\144\141\164\x61", true); goto t2AI3; oLWbQ: xhT7o: goto N3_0i; RR5fI: sleep(1); goto qeCRp; dfZ98: $this->output_json($data); goto Ulfbq; N3_0i: $data["\x73\165\x63\143\x65\163\163"] = $this->runQuery($queries); goto XfKUa; t2AI3: str_replace("\x25\x32\102", "\53", $scripts); goto RR5fI; vU2Pp: $queries = ''; goto FN8gd; Ulfbq: } public function createColumn() { goto ITukN; DApOZ: $this->updateUID(); goto IwuYd; lp3TA: $data["\x73\165\x63\x63\x65\163\163"] = $this->runQuery($queries); goto Tz82Y; ITukN: $scripts = $this->input->post("\144\x61\164\141", true); goto QoR5p; NtVLU: $scripts = json_decode($this->encryption->decrypt($scripts)); goto K7LGo; si8Jc: GjHlg: goto LTg9T; LTg9T: if (!(strpos("\140\x75\x69\144\140", $queries) !== false)) { goto qyk1S; } goto DApOZ; Yq_0M: $this->output_json($data); goto RS793; K7LGo: $queries = ''; goto iFPOo; Tz82Y: $data["\155\x65\163\163\141\147\x65"] = "\115\157\x64\151\146\x79\x20\x6b\x6f\154\157\x6d"; goto Yq_0M; xRBbB: sleep(1); goto NtVLU; iFPOo: foreach ($scripts as $script) { $queries .= $script; oLlKW: } goto si8Jc; QoR5p: str_replace("\45\x32\102", "\53", $scripts); goto xRBbB; IwuYd: qyk1S: goto lp3TA; RS793: } public function editColumn() { goto QRSd5; OFyH1: $queries = ''; goto qHThU; qHThU: foreach ($scripts as $script) { $queries .= $script; SsrZh: } goto pINrN; ZZ_RP: $data["\155\145\163\x73\x61\147\x65"] = "\125\160\144\141\164\x65\x20\x73\145\154\x65\x73\x61\x69"; goto O6Xmf; pINrN: Tfu2v: goto B33e3; J06Yr: str_replace("\x25\62\x42", "\53", $scripts); goto Fkw_L; QRSd5: $scripts = $this->input->post("\x64\141\x74\x61", true); goto J06Yr; O6Xmf: $this->output_json($data); goto P2jNX; Hi5WG: $scripts = json_decode($this->encryption->decrypt($scripts)); goto OFyH1; B33e3: $data["\x73\x75\143\x63\145\x73\163"] = $this->runQuery($queries); goto ZZ_RP; Fkw_L: sleep(1); goto Hi5WG; P2jNX: } function runQuery($script) { goto LwVEv; WnPOY: return mysqli_connect_errno(); goto dKlxf; bnBAJ: $database = $this->db->database; goto ceErk; LwVEv: $hostname = $this->db->hostname; goto xIozL; oi00D: $mysqli->multi_query($script); goto Vaesw; repb9: $hostpass = $this->db->password; goto bnBAJ; dKlxf: fuvcX: goto oi00D; LI487: return true; goto MGvME; Vaesw: $mysqli->close(); goto LI487; TUM2O: if (!mysqli_connect_errno()) { goto fuvcX; } goto WnPOY; ceErk: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto TUM2O; xIozL: $hostuser = $this->db->username; goto repb9; MGvME: } function updateUID() { goto G7R3E; baCCd: foreach ($siswas as $siswa) { $input[] = array("\x69\144\x5f\163\151\x73\x77\141" => $siswa->id_siswa, "\165\151\x64" => $this->uuid->v4()); wqkF2: } goto oCugo; x0xWV: $siswas = $this->db->get("\155\x61\163\x74\145\x72\x5f\163\151\163\167\x61")->result(); goto AVSo3; oCugo: D2Oa5: goto SsK4u; G7R3E: $this->load->library("\x55\x75\151\x64", "\165\165\x69\144"); goto x0xWV; SsK4u: return $this->db->update_batch("\x6d\x61\x73\164\x65\162\x5f\x73\x69\x73\167\x61", $input, "\x69\x64\x5f\163\x69\163\167\141"); goto oHmi8; AVSo3: $input = array(); goto baCCd; oHmi8: } function make_base() { } }
