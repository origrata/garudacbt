<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\x45\120\x41\124\x48") or exit("\116\x6f\40\144\151\x72\x65\x63\x74\40\x73\x63\162\x69\x70\164\40\141\143\x63\145\163\163\40\x61\x6c\154\x6f\x77\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto rQJfB; kKZxn: $CI =& get_instance(); goto hIjOG; ucjLK: $this->messages = []; goto n5pqg; SxHy9: $this->hash_method = $this->config->item("\x68\141\163\150\x5f\x6d\x65\x74\x68\x6f\144", "\x69\x6f\x6e\137\141\x75\164\x68"); goto ucjLK; bDbFw: $this->message_start_delimiter = $this->error_start_delimiter; goto jKp3h; vCXSp: goto BwLUc; goto Ns6Tq; n5pqg: $this->errors = []; goto Hly5X; SsMNY: $error_suffix->setAccessible(TRUE); goto I3ZlX; Hly5X: $delimiters_source = $this->config->item("\144\x65\x6c\151\155\x69\x74\145\x72\163\x5f\163\x6f\x75\162\143\145", "\x69\x6f\x6e\x5f\141\x75\164\x68"); goto TBs8h; lpOIC: $this->_ion_hooks = new stdClass(); goto hdaI9; e7321: $this->message_start_delimiter = $this->config->item("\x6d\145\163\163\x61\147\x65\137\x73\x74\x61\x72\164\137\x64\145\154\x69\155\x69\164\145\162", "\x69\x6f\x6e\137\141\165\164\x68"); goto c8pZr; jt4x8: goto gqt_f; goto V9u3x; zK7SP: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto bDbFw; lGXNl: gqt_f: goto gc3eX; zG6pj: $this->message_end_delimiter = $this->error_end_delimiter; goto igtek; W0nMO: $this->load->library("\x66\157\x72\155\137\166\141\x6c\x69\144\x61\164\151\157\156"); goto lvAN5; TBs8h: if ($delimiters_source === "\x66\x6f\x72\155\137\166\x61\154\x69\x64\141\164\x69\157\156") { goto fd0Ls; } goto e7321; J5vFl: $this->lang->load("\151\x6f\156\137\141\x75\x74\150"); goto H4LPm; NU_fl: if (empty($group_name)) { goto D7vwe; } goto q26XW; syUqr: $error_prefix->setAccessible(TRUE); goto zK7SP; VFeDD: $this->error_start_delimiter = $this->config->item("\145\x72\162\157\162\x5f\x73\164\x61\x72\164\137\144\145\x6c\151\x6d\x69\164\145\x72", "\x69\157\x6e\137\141\x75\x74\x68"); goto nVWyw; jKp3h: $error_suffix = $form_validation_class->getProperty("\137\x65\x72\162\157\x72\x5f\163\x75\146\x66\151\170"); goto SsMNY; Ns6Tq: fd0Ls: goto W0nMO; nVWyw: $this->error_end_delimiter = $this->config->item("\145\162\x72\157\162\x5f\x65\x6e\x64\x5f\144\x65\154\x69\155\151\164\145\162", "\x69\157\156\137\x61\x75\164\150"); goto vCXSp; H4LPm: $group_name = $this->config->item("\144\141\x74\141\142\141\x73\145\137\x67\162\157\x75\x70\137\156\141\155\145", "\151\x6f\156\137\141\165\x74\x68"); goto NU_fl; V9u3x: D7vwe: goto kKZxn; uDhaW: $this->load->helper("\144\141\164\x65"); goto J5vFl; I3ZlX: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto zG6pj; yr0KZ: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\162\x6f\162\x5f\160\x72\x65\146\x69\170"); goto syUqr; rQJfB: $this->config->load("\151\157\x6e\x5f\x61\x75\164\x68", TRUE); goto iX0SR; hIjOG: $this->db = $CI->db; goto lGXNl; c8pZr: $this->message_end_delimiter = $this->config->item("\x6d\145\163\163\141\147\x65\137\145\x6e\x64\x5f\x64\145\x6c\151\155\x69\164\145\x72", "\x69\157\156\137\141\165\164\x68"); goto VFeDD; hdaI9: $this->trigger_events("\x6d\x6f\144\145\x6c\x5f\x63\x6f\156\x73\x74\x72\165\143\x74\x6f\162"); goto fUGcd; q26XW: $this->db = $this->load->database($group_name, TRUE, TRUE); goto jt4x8; igtek: BwLUc: goto lpOIC; iX0SR: $this->load->helper("\x63\157\x6f\x6b\151\x65"); goto uDhaW; lvAN5: $form_validation_class = new ReflectionClass("\x43\111\137\x46\x6f\x72\155\137\166\x61\x6c\151\144\141\164\x69\157\x6e"); goto yr0KZ; uflx2: $this->identity_column = $this->config->item("\151\x64\145\156\x74\x69\164\171", "\151\x6f\156\137\141\x75\164\150"); goto IegNg; gc3eX: $this->tables = $this->config->item("\164\x61\x62\x6c\x65\163", "\x69\157\x6e\x5f\141\x75\x74\150"); goto uflx2; IegNg: $this->join = $this->config->item("\152\x6f\x69\x6e", "\x69\157\x6e\137\141\x75\x74\150"); goto SxHy9; fUGcd: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto evoF7; uboeE: return password_hash($password, $algo, $params); goto NNnQ6; Rf09d: $algo = $this->_get_hash_algo(); goto QhuQo; QkWWm: F0lTU: goto Rf09d; ASOvV: return FALSE; goto QkWWm; M8ir7: if (!($algo !== FALSE && $params !== FALSE)) { goto Ncxzk; } goto uboeE; NNnQ6: Ncxzk: goto Rv3bZ; QhuQo: $params = $this->_get_hash_parameters($identity); goto M8ir7; evoF7: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto F0lTU; } goto ASOvV; Rv3bZ: return FALSE; goto PwY9o; PwY9o: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto a9Z1N; a9Z1N: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto awkXE; } goto kWsKz; TREWA: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto It73m; OWfSB: awkXE: goto MDUxa; MDUxa: if (strpos($hash_password_db, "\x24") === 0) { goto BmZuN; } goto TREWA; It73m: goto BxkUz; goto e6_Cq; kWsKz: return FALSE; goto OWfSB; Xhbor: return password_verify($password, $hash_password_db); goto oUFSg; oUFSg: BxkUz: goto hVT2B; e6_Cq: BmZuN: goto Xhbor; hVT2B: } public function rehash_password_if_needed($hash, $identity, $password) { goto P_RMu; gXfyh: DJvy2: goto wXr2K; fm53s: if (!password_needs_rehash($hash, $algo, $params)) { goto DJvy2; } goto Ec32s; oMMaN: if (!($algo !== FALSE && $params !== FALSE)) { goto I088L; } goto fm53s; xNCLg: $params = $this->_get_hash_parameters($identity); goto oMMaN; mVsJ_: bvL9j: goto oOsja; P_RMu: $algo = $this->_get_hash_algo(); goto xNCLg; hDAAF: $this->trigger_events(["\162\145\x68\x61\x73\150\x5f\x70\141\x73\163\x77\157\162\144", "\x72\145\150\141\163\150\137\160\x61\163\x73\167\x6f\x72\144\x5f\165\x6e\x73\165\x63\x63\145\x73\163\x66\x75\154"]); goto ZbQij; oOsja: $this->trigger_events(["\162\x65\x68\141\163\x68\x5f\160\141\x73\163\x77\157\x72\x64", "\x72\145\x68\141\x73\x68\137\x70\x61\163\163\x77\157\x72\x64\x5f\163\x75\143\143\145\163\x73\x66\x75\x6c"]); goto RXI8Y; ZbQij: goto myp04; goto mVsJ_; RXI8Y: myp04: goto gXfyh; wXr2K: I088L: goto V8BeW; Ec32s: if ($this->_set_password_db($identity, $password)) { goto bvL9j; } goto hDAAF; V8BeW: } public function get_user_by_activation_code($user_code) { goto acNnV; l_Y6j: return FALSE; goto YCs4q; acNnV: $token = $this->_retrieve_selector_validator_couple($user_code); goto dnz0D; MJ63o: if (!$user) { goto bxOSH; } goto gSQfc; IMDos: bxOSH: goto l_Y6j; bU86t: return $user; goto zC6v2; dnz0D: $user = $this->where("\x61\143\164\151\x76\141\164\151\x6f\x6e\x5f\163\x65\154\x65\143\x74\157\x72", $token->selector)->users()->row(); goto MJ63o; zC6v2: wD1qP: goto IMDos; gSQfc: if (!$this->verify_password($token->validator, $user->activation_code)) { goto wD1qP; } goto bU86t; YCs4q: } public function activate($id, $code = FALSE) { goto MVRN1; jz8zX: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x61\x63\x74\151\x76\141\x74\x65", "\160\x6f\163\164\x5f\x61\x63\x74\x69\166\141\x74\x65\137\x75\x6e\x73\165\143\x63\x65\163\x73\x66\165\x6c"]); goto MQG17; im5PC: $user = $this->get_user_by_activation_code($code); goto hX2UB; pQkLD: $this->set_message("\141\x63\164\x69\x76\141\x74\x65\x5f\163\165\143\143\x65\163\x73\x66\x75\x6c"); goto KRCOy; sYNZ_: if (!($code === FALSE || $user && $user->id === $id)) { goto C5Yk7; } goto p_LS2; MVRN1: $this->trigger_events("\160\x72\145\137\x61\x63\x74\x69\166\141\164\x65"); goto tIWuc; V18T0: $this->trigger_events(["\x70\x6f\163\164\137\x61\x63\x74\151\166\141\x74\145", "\160\157\163\164\137\141\143\x74\151\x76\x61\x74\145\137\x73\x75\143\143\145\x73\163\146\x75\154"]); goto pQkLD; tIWuc: if (!($code !== FALSE)) { goto z6Hi2; } goto im5PC; hX2UB: z6Hi2: goto sYNZ_; kWg2r: C5Yk7: goto jz8zX; En0zE: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, ["\x69\x64" => $id]); goto Q8y5y; dErk2: cWt1f: goto kWg2r; KRCOy: return TRUE; goto dErk2; pBE2J: $this->trigger_events("\145\170\164\162\141\137\x77\x68\x65\162\x65"); goto En0zE; lRl5z: return FALSE; goto Inj1f; MQG17: $this->set_error("\x61\x63\164\151\x76\x61\x74\x65\137\x75\156\x73\165\143\143\x65\x73\163\146\165\154"); goto lRl5z; Q8y5y: if (!($this->db->affected_rows() === 1)) { goto cWt1f; } goto V18T0; p_LS2: $data = ["\141\143\164\151\166\x61\164\x69\x6f\156\x5f\163\x65\154\145\143\x74\x6f\162" => NULL, "\x61\x63\x74\151\x76\141\x74\151\157\x6e\x5f\143\157\x64\x65" => NULL, "\141\x63\164\151\x76\x65" => 1]; goto pBE2J; Inj1f: } public function deactivate($id = NULL) { goto KT70g; Tpg7y: return FALSE; goto t3dbe; wJxYh: if (!isset($id)) { goto qsyxZ; } goto hV_tW; zKi7U: $this->set_error("\x64\x65\x61\143\164\x69\166\141\164\x65\x5f\165\156\163\165\143\143\145\x73\x73\146\165\154"); goto Tpg7y; QSapG: if ($return) { goto SumTi; } goto RRxqY; y70WS: $data = ["\141\143\x74\x69\166\x61\x74\151\157\156\x5f\x73\145\x6c\145\143\x74\x6f\x72" => $token->selector, "\141\143\164\x69\x76\x61\164\x69\x6f\156\137\143\157\x64\x65" => $token->validator_hashed, "\141\x63\164\151\166\145" => 0]; goto X3HB8; vfezm: $this->set_error("\144\145\x61\x63\164\151\x76\141\x74\x65\137\143\165\162\162\145\x6e\x74\x5f\x75\163\145\162\137\165\x6e\x73\x75\143\143\x65\163\x73\146\165\154"); goto XM2v6; AOqSl: goto xLS5E; goto PN3eg; PN3eg: SumTi: goto z24Ow; RRxqY: $this->set_error("\144\x65\x61\x63\x74\x69\x76\x61\x74\145\137\165\x6e\163\x75\143\143\145\163\x73\146\x75\x6c"); goto AOqSl; pB6YP: $this->activation_code = $token->user_code; goto y70WS; z24Ow: $this->set_message("\144\145\141\143\164\x69\166\x61\164\x65\137\163\165\x63\143\145\x73\163\146\165\x6c"); goto hYdTV; hV_tW: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto B0ts0; } goto vfezm; XM2v6: return FALSE; goto lU65w; hYdTV: xLS5E: goto HHohn; FMwKc: goto pzlZl; goto gxxqM; KT70g: $this->trigger_events("\144\x65\141\143\164\x69\166\x61\164\x65"); goto wJxYh; t3dbe: pzlZl: goto ll01o; ll01o: $token = $this->_generate_selector_validator_couple(20, 40); goto pB6YP; lU65w: B0ts0: goto FMwKc; X3HB8: $this->trigger_events("\145\x78\164\x72\141\137\167\150\145\162\145"); goto bx4wH; bx4wH: $this->db->update($this->tables["\x75\x73\145\162\x73"], $data, ["\x69\144" => $id]); goto D1w_n; HHohn: return $return; goto nTAqD; D1w_n: $return = $this->db->affected_rows() == 1; goto QSapG; gxxqM: qsyxZ: goto zKi7U; nTAqD: } public function clear_forgotten_password_code($identity) { goto oSrrc; m3XSj: $this->db->update($this->tables["\x75\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto MvnHh; i05v8: fVreN: goto UwLww; pAcm5: return FALSE; goto i05v8; oSrrc: if (!empty($identity)) { goto fVreN; } goto pAcm5; MvnHh: return TRUE; goto R0Igq; UwLww: $data = ["\x66\x6f\162\147\157\x74\x74\x65\x6e\137\160\141\x73\x73\167\x6f\162\x64\137\163\x65\154\145\143\164\157\162" => NULL, "\146\x6f\x72\147\157\x74\164\145\x6e\x5f\160\141\163\163\167\x6f\162\144\x5f\143\157\x64\145" => NULL, "\x66\x6f\162\x67\x6f\164\164\x65\156\137\x70\x61\x73\163\167\157\162\x64\137\164\151\155\x65" => NULL]; goto m3XSj; R0Igq: } public function clear_remember_code($identity) { goto poJB_; LkY5L: jtFJC: goto EAI0Z; mwZJ8: return FALSE; goto LkY5L; z9a6q: return TRUE; goto KgcuV; EAI0Z: $data = ["\162\x65\x6d\x65\155\x62\x65\x72\137\163\x65\x6c\145\143\x74\x6f\x72" => NULL, "\x72\145\x6d\x65\155\142\x65\162\137\x63\x6f\144\x65" => NULL]; goto gm6_r; gm6_r: $this->db->update($this->tables["\165\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto z9a6q; poJB_: if (!empty($identity)) { goto jtFJC; } goto mwZJ8; KgcuV: } public function reset_password($identity, $new) { goto PsTMt; J3i8u: CBLuW: goto sJHXK; sJHXK: return $return; goto o46RA; MACwj: if ($return) { goto eA2Um; } goto JZPcM; JZPcM: $this->trigger_events(["\x70\x6f\x73\x74\137\143\150\x61\x6e\147\145\137\160\x61\x73\163\167\157\162\x64", "\160\x6f\x73\x74\137\x63\150\141\x6e\147\145\x5f\160\x61\163\x73\x77\x6f\162\144\137\x75\x6e\x73\x75\x63\143\x65\x73\163\146\165\154"]); goto xuall; Ap4lW: $this->trigger_events(["\160\157\x73\164\x5f\x63\x68\141\156\147\145\137\160\141\x73\163\x77\x6f\x72\144", "\160\157\163\x74\137\x63\150\141\156\x67\145\x5f\x70\x61\163\163\x77\157\x72\144\137\x75\156\163\165\143\143\x65\163\x73\146\x75\x6c"]); goto DkJWS; c4ZrA: goto CBLuW; goto P8M9G; FoXaO: if ($this->identity_check($identity)) { goto bV8Zz; } goto Ap4lW; PsTMt: $this->trigger_events("\160\162\x65\137\143\x68\x61\x6e\147\145\137\x70\141\163\x73\167\157\x72\x64"); goto FoXaO; vo3gj: bV8Zz: goto j98S2; P8M9G: eA2Um: goto CvNVX; xuall: $this->set_error("\x70\x61\x73\x73\x77\x6f\162\x64\x5f\x63\x68\141\x6e\x67\x65\x5f\165\156\163\x75\143\x63\x65\x73\163\x66\x75\x6c"); goto c4ZrA; DkJWS: return FALSE; goto vo3gj; CvNVX: $this->trigger_events(["\x70\157\163\x74\x5f\x63\150\x61\156\147\x65\137\x70\x61\x73\x73\167\x6f\x72\144", "\x70\157\x73\164\137\143\x68\x61\156\147\145\137\x70\141\x73\x73\167\x6f\x72\144\x5f\x73\165\x63\143\145\163\x73\146\165\154"]); goto h6RrI; j98S2: $return = $this->_set_password_db($identity, $new); goto MACwj; h6RrI: $this->set_message("\160\x61\163\163\x77\157\162\x64\x5f\x63\150\141\x6e\147\145\x5f\x73\x75\x63\143\x65\x73\163\146\x75\154"); goto J3i8u; o46RA: } public function change_password($identity, $old, $new) { goto ZaSB1; EGZXp: if ($result) { goto YW6N7; } goto KospP; WJSNC: $this->trigger_events("\145\170\x74\162\x61\137\167\150\145\x72\x65"); goto ibKfQ; A1Anc: $this->trigger_events(["\160\157\x73\x74\x5f\x63\150\x61\x6e\147\145\137\160\141\x73\x73\x77\x6f\162\x64", "\x70\157\x73\x74\137\x63\x68\x61\156\x67\145\137\160\x61\163\x73\x77\157\x72\x64\137\165\x6e\163\165\x63\x63\145\163\163\x66\165\x6c"]); goto TDYSx; N84dk: yKa5s: goto VwMM1; RhPeN: $this->set_error("\x70\141\x73\x73\x77\157\x72\x64\137\x63\150\x61\x6e\x67\x65\137\165\156\163\165\x63\x63\145\x73\163\146\x75\154"); goto ozfYX; pcUja: nSrny: goto RhPeN; ibKfQ: $query = $this->db->select("\151\144\x2c\40\x70\141\x73\163\167\x6f\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\x73\143")->get($this->tables["\x75\163\145\162\163"]); goto OJDg0; VwMM1: return $result; goto pcUja; OJDg0: if (!($query->num_rows() !== 1)) { goto dQIcD; } goto A1Anc; IZ7hg: $result = $this->_set_password_db($identity, $new); goto EGZXp; G5Ome: $user = $query->row(); goto izygU; ZaSB1: $this->trigger_events("\160\162\x65\x5f\x63\150\141\x6e\x67\145\x5f\160\141\x73\163\167\x6f\x72\x64"); goto WJSNC; TDYSx: $this->set_error("\x70\x61\x73\x73\x77\x6f\162\144\x5f\143\x68\x61\156\x67\x65\137\165\x6e\x73\165\x63\x63\x65\163\163\146\165\x6c"); goto tT2pO; FD5Pz: goto yKa5s; goto y1gt3; CLAVC: $this->trigger_events(["\160\x6f\x73\x74\137\x63\150\x61\x6e\x67\x65\x5f\160\141\x73\x73\167\157\162\144", "\160\157\x73\x74\x5f\143\x68\141\156\147\x65\137\160\141\x73\163\x77\157\x72\x64\137\163\165\143\x63\145\x73\163\x66\165\x6c"]); goto UxLpy; ZQiPZ: dQIcD: goto G5Ome; UxLpy: $this->set_message("\x70\141\x73\x73\167\157\x72\144\137\x63\x68\x61\156\x67\145\137\163\x75\x63\143\x65\x73\x73\146\x75\x6c"); goto N84dk; rxXGS: $this->set_error("\160\141\163\163\167\157\162\144\x5f\x63\x68\x61\156\x67\145\137\165\156\163\x75\x63\143\145\163\x73\x66\165\x6c"); goto FD5Pz; y1gt3: YW6N7: goto CLAVC; KospP: $this->trigger_events(["\160\157\163\164\137\143\150\x61\156\x67\145\137\x70\x61\x73\163\167\x6f\162\x64", "\160\157\x73\164\137\143\x68\141\x6e\147\145\x5f\160\x61\x73\x73\167\x6f\x72\x64\137\x75\x6e\163\165\x63\x63\x65\x73\163\146\x75\154"]); goto rxXGS; ozfYX: return FALSE; goto VCs04; izygU: if (!$this->verify_password($old, $user->password, $identity)) { goto nSrny; } goto IZ7hg; tT2pO: return FALSE; goto ZQiPZ; VCs04: } public function username_check($username = '') { goto xTJ8V; tRbgx: if (!empty($username)) { goto J17p1; } goto iG_nI; xTJ8V: $this->trigger_events("\165\163\x65\x72\156\x61\155\x65\137\143\x68\x65\143\153"); goto tRbgx; Rn6kd: J17p1: goto H2EWS; he4qn: return $this->db->where("\x75\x73\x65\162\156\141\155\145", $username)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\x73"]) > 0; goto RC_wS; H2EWS: $this->trigger_events("\145\170\x74\162\141\137\x77\150\x65\x72\x65"); goto he4qn; iG_nI: return FALSE; goto Rn6kd; RC_wS: } public function email_check($email = '') { goto rXp2_; zJ2la: $this->trigger_events("\145\x78\164\x72\x61\x5f\167\x68\145\x72\145"); goto RRnMM; XXq1c: Hfznl: goto zJ2la; RRnMM: return $this->db->where("\x65\x6d\x61\151\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\163\x65\x72\x73"]) > 0; goto TBrEg; cwRFx: return FALSE; goto XXq1c; rXp2_: $this->trigger_events("\145\x6d\x61\151\x6c\137\x63\x68\x65\x63\153"); goto YQOVm; YQOVm: if (!empty($email)) { goto Hfznl; } goto cwRFx; TBrEg: } public function identity_check($identity = '') { goto EE2eo; jSswk: if (!empty($identity)) { goto I0iTk; } goto DE2Bl; EE2eo: $this->trigger_events("\x69\144\145\156\x74\x69\164\171\137\x63\150\x65\x63\153"); goto jSswk; QALOy: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\145\162\x73"]) > 0; goto LBujh; DE2Bl: return FALSE; goto JubGc; JubGc: I0iTk: goto QALOy; LBujh: } public function get_user_id_from_identity($identity = '') { goto I9OE1; wyK4c: mCO97: goto wz588; Mh3GU: return $user->id; goto fIHM7; wz588: $user = $query->row(); goto Mh3GU; NnzVb: return FALSE; goto Jg2RI; Odknx: if (!($query->num_rows() !== 1)) { goto mCO97; } goto ERwvu; ERwvu: return FALSE; goto wyK4c; Jg2RI: cYJnn: goto TIrt_; I9OE1: if (!empty($identity)) { goto cYJnn; } goto NnzVb; TIrt_: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\145\162\163"]); goto Odknx; fIHM7: } public function forgotten_password($identity) { goto y3xTD; Bh0xb: xNX4Z: goto hqVT5; WfxSp: if ($this->db->affected_rows() === 1) { goto HlpQU; } goto yCdlB; IqgCN: goto f6YOw; goto vbHYj; ZimZ1: return FALSE; goto IqgCN; lg02w: return $token->user_code; goto Xe9vY; y3xTD: if (!empty($identity)) { goto xNX4Z; } goto fvyH9; s5xN6: $this->trigger_events(["\160\x6f\163\x74\x5f\x66\x6f\162\147\157\164\x74\145\x6e\x5f\160\x61\163\x73\167\157\162\x64", "\x70\x6f\x73\x74\137\x66\x6f\x72\x67\157\164\x74\x65\156\137\x70\141\x73\163\167\157\162\x64\x5f\163\165\x63\x63\145\163\163\146\x75\154"]); goto lg02w; fvyH9: $this->trigger_events(["\x70\x6f\163\x74\137\146\157\162\x67\x6f\x74\164\145\156\x5f\160\x61\163\163\x77\x6f\162\x64", "\160\x6f\163\x74\137\x66\x6f\x72\x67\157\164\x74\x65\156\137\160\x61\x73\x73\x77\x6f\x72\x64\x5f\165\x6e\x73\x75\143\x63\x65\163\x73\x66\x75\154"]); goto O5Kte; hqVT5: $token = $this->_generate_selector_validator_couple(20, 80); goto Co5EF; TQbJU: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $update, [$this->identity_column => $identity]); goto WfxSp; Co5EF: $update = ["\x66\x6f\x72\x67\157\x74\164\x65\x6e\137\x70\x61\163\x73\167\x6f\162\144\x5f\163\x65\154\x65\143\x74\x6f\162" => $token->selector, "\146\x6f\162\x67\x6f\164\x74\145\156\x5f\x70\x61\x73\163\167\157\x72\144\137\143\x6f\144\145" => $token->validator_hashed, "\x66\x6f\162\x67\157\x74\164\145\x6e\137\160\141\x73\x73\167\x6f\x72\144\137\x74\x69\x6d\x65" => time()]; goto ZD1IL; yCdlB: $this->trigger_events(["\x70\157\x73\164\x5f\146\157\162\x67\x6f\164\x74\145\156\137\x70\141\163\163\x77\157\x72\144", "\160\157\x73\x74\x5f\146\157\x72\x67\x6f\164\164\x65\156\x5f\160\141\163\163\x77\x6f\x72\x64\x5f\x75\156\163\165\143\x63\x65\163\163\x66\165\154"]); goto ZimZ1; O5Kte: return FALSE; goto Bh0xb; vbHYj: HlpQU: goto s5xN6; Xe9vY: f6YOw: goto MrJx6; ZD1IL: $this->trigger_events("\145\170\164\x72\x61\x5f\167\150\145\x72\x65"); goto TQbJU; MrJx6: } public function get_user_by_forgotten_password_code($user_code) { goto fHm76; iFlQE: return $user; goto HrPZ0; HrPZ0: HpAFJ: goto VFtrq; B714U: $user = $this->where("\146\x6f\162\147\x6f\164\x74\x65\x6e\137\x70\141\163\163\x77\x6f\162\144\x5f\x73\145\x6c\x65\x63\x74\157\162", $token->selector)->users()->row(); goto AIDXo; EA0DL: return FALSE; goto sPpKH; fHm76: $token = $this->_retrieve_selector_validator_couple($user_code); goto B714U; yUOu4: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto HpAFJ; } goto iFlQE; AIDXo: if (!$user) { goto jhVtv; } goto yUOu4; VFtrq: jhVtv: goto EA0DL; sPpKH: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto R2nbP; x3afL: $this->set_error("\141\x63\x63\x6f\165\156\x74\137\x63\162\x65\141\x74\x69\157\x6e\x5f\165\x6e\163\x75\143\143\145\163\163\x66\165\x6c"); goto xXhlr; UIkf2: tL3tN: goto BhMmh; BhMmh: $query = $this->db->get_where($this->tables["\147\x72\x6f\x75\160\x73"], ["\x6e\141\x6d\x65" => $this->config->item("\144\x65\x66\x61\165\x6c\164\x5f\x67\162\157\165\160", "\x69\157\156\x5f\141\x75\164\150")], 1)->row(); goto SzMhV; IOuIn: $this->trigger_events("\x70\x6f\x73\164\137\x72\145\147\151\x73\x74\145\162"); goto C0pvM; C3EsD: return FALSE; goto iACUN; AK1G_: $password = $this->hash_password($password); goto UW_Aw; yqOA2: if ($this->identity_check($identity)) { goto qs6Ag; } goto XT3qO; zyNVm: I0qRK: goto nra4I; m37tw: foreach ($groups as $group) { $this->add_to_group($group, $id); XmNA4: } goto Q22TS; QpL4C: $this->db->insert($this->tables["\165\163\x65\x72\163"], $user_data); goto m5a3E; R2nbP: $this->trigger_events("\160\162\x65\137\162\x65\147\151\163\164\x65\162"); goto opfEb; wxZxj: $this->set_error("\x61\143\143\x6f\165\x6e\164\137\x63\162\x65\141\x74\151\157\x6e\x5f\x6d\151\163\163\x69\156\147\137\x64\x65\x66\141\x75\154\164\137\x67\162\157\x75\x70"); goto WD930; FL_Ob: lHOXN: goto IOuIn; m5a3E: $id = $this->db->insert_id($this->tables["\165\163\145\162\x73"] . "\137\151\x64\137\163\x65\161"); goto IyhZP; Q22TS: vjck0: goto FL_Ob; opfEb: $manual_activation = $this->config->item("\x6d\141\x6e\x75\x61\154\137\x61\x63\164\151\166\141\164\151\157\x6e", "\x69\x6f\156\x5f\141\165\164\x68"); goto yqOA2; nra4I: goto tL3tN; goto iNbLy; FWeoj: return FALSE; goto UIkf2; iACUN: dtheY: goto QkYOk; GeZjm: D7IQN: goto FRQ6u; UW_Aw: if (!($password === FALSE)) { goto D7IQN; } goto x3afL; xXhlr: return FALSE; goto GeZjm; iNbLy: qs6Ag: goto HEjHD; expWK: if (empty($groups)) { goto lHOXN; } goto m37tw; qWVuP: $ip_address = $this->input->ip_address(); goto AK1G_; WD930: return FALSE; goto zyNVm; F8j22: nr9ID: goto expWK; HEjHD: $this->set_error("\x61\x63\x63\x6f\x75\x6e\164\x5f\x63\162\145\x61\164\x69\x6f\156\137\x64\x75\160\x6c\151\x63\x61\164\x65\x5f\x69\144\145\156\164\151\164\x79"); goto FWeoj; FRQ6u: $data = [$this->identity_column => $identity, "\x75\x73\145\162\156\x61\x6d\x65" => $identity, "\160\x61\x73\163\x77\x6f\162\144" => $password, "\x65\x6d\x61\x69\x6c" => $email, "\151\160\137\x61\144\x64\x72\145\163\x73" => $ip_address, "\x63\162\145\141\x74\145\x64\137\157\156" => time(), "\x61\x63\164\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto lixdr; zWvTA: $groups[] = $default_group->id; goto F8j22; eXQVv: $this->set_error("\141\143\143\x6f\165\156\164\137\x63\x72\145\x61\x74\151\157\156\x5f\x69\156\166\x61\x6c\x69\x64\137\144\145\x66\141\x75\x6c\164\x5f\147\162\157\x75\x70"); goto C3EsD; IyhZP: if (!(isset($default_group->id) && empty($groups))) { goto nr9ID; } goto zWvTA; XT3qO: if (!(!$this->config->item("\x64\x65\146\x61\165\x6c\164\x5f\147\162\x6f\x75\x70", "\151\x6f\156\137\141\165\x74\x68") && empty($groups))) { goto I0qRK; } goto wxZxj; lixdr: $user_data = array_merge($this->_filter_data($this->tables["\165\163\x65\x72\163"], $additional_data), $data); goto x6vWy; QkYOk: $default_group = $query; goto qWVuP; C0pvM: return isset($id) ? $id : FALSE; goto kaAw4; SzMhV: if (!(!isset($query->id) && empty($groups))) { goto dtheY; } goto eXQVv; x6vWy: $this->trigger_events("\145\170\x74\x72\x61\137\x73\145\164"); goto QpL4C; kaAw4: } public function login($identity, $password, $remember = FALSE) { goto Xisf7; t1UxI: if (!$this->config->item("\x72\x65\155\x65\x6d\142\145\162\x5f\x75\x73\145\x72\163", "\151\x6f\x6e\137\141\x75\x74\150")) { goto unjbL; } goto BJenk; GZrdz: $user = $query->row(); goto nUC_w; ZB68c: $this->trigger_events("\x70\157\x73\164\x5f\x6c\x6f\x67\151\156\x5f\165\x6e\163\165\x63\143\x65\163\x73\x66\165\x6c"); goto Jhw87; HPw5D: $this->set_session($user); goto x9Wa1; j3vt3: $this->rehash_password_if_needed($user->password, $identity, $password); goto Ly8Zc; eVgDH: $this->set_message("\154\157\147\151\156\137\163\x75\x63\143\145\x73\x73\x66\x75\154"); goto o3x5V; dzb9t: $this->trigger_events("\x65\170\x74\162\x61\137\x77\150\x65\x72\x65"); goto aF0fR; Ly8Zc: $this->session->sess_regenerate(FALSE); goto SKY4U; t03K4: O_0Hn: goto jVutp; SKY4U: $this->trigger_events(["\160\x6f\x73\x74\x5f\154\157\147\151\156", "\x70\x6f\x73\164\137\x6c\157\147\151\x6e\137\163\165\x63\143\x65\x73\163\146\165\154"]); goto eVgDH; KbzxK: $this->trigger_events("\160\157\163\164\x5f\154\x6f\x67\151\x6e\x5f\x75\x6e\163\165\x63\143\x65\163\x73\x66\165\154"); goto ekVnZ; x9Wa1: $this->update_last_login($user->id); goto mQKBl; lRq3t: return FALSE; goto EgpCL; LCe_x: $this->clear_forgotten_password_code($identity); goto t1UxI; RMrHZ: unjbL: goto j3vt3; jVutp: TtkT1: goto X_JYO; fEu1B: $this->remember_user($identity); goto xXAJA; BoFhx: goto hsMGn; goto pedPH; bbNJJ: $this->set_error("\x6c\x6f\x67\x69\x6e\137\x75\x6e\x73\165\143\x63\145\163\163\x66\165\154"); goto lRq3t; Ge1Y0: if (!($user->active == 0)) { goto bi2hx; } goto KbzxK; Jhw87: $this->set_error("\x6c\157\x67\151\156\x5f\164\151\x6d\145\157\x75\x74"); goto B2tSy; o3x5V: return TRUE; goto t03K4; Ob3hb: $this->increase_login_attempts($identity); goto B9PYQ; r1Kmz: $this->set_error("\154\x6f\x67\x69\156\137\x75\156\x73\x75\x63\143\x65\x73\163\146\x75\x6c"); goto a1LoS; gCtdt: $this->clear_remember_code($identity); goto BoFhx; AxLVX: bi2hx: goto HPw5D; X_JYO: $this->hash_password($password); goto Ob3hb; nUC_w: if (!$this->verify_password($password, $user->password, $identity)) { goto O_0Hn; } goto Ge1Y0; GgMwm: $this->hash_password($password); goto ZB68c; ekVnZ: $this->set_error("\x6c\x6f\147\151\x6e\x5f\165\x6e\x73\x75\x63\x63\x65\x73\163\146\165\154\x5f\156\157\x74\137\x61\143\x74\151\166\145"); goto gZ3z2; BJenk: if ($remember) { goto MEu1r; } goto gCtdt; jpYrx: if (!(empty($identity) || empty($password))) { goto Ocxjr; } goto bbNJJ; A__Qp: if (!($query->num_rows() === 1)) { goto TtkT1; } goto GZrdz; Xisf7: $this->trigger_events("\160\x72\145\x5f\x6c\x6f\147\151\x6e"); goto jpYrx; pedPH: MEu1r: goto fEu1B; Xr0Qm: QNVSH: goto A__Qp; EgpCL: Ocxjr: goto dzb9t; bzOM6: if (!$this->is_max_login_attempts_exceeded($identity)) { goto QNVSH; } goto GgMwm; B2tSy: return FALSE; goto Xr0Qm; a1LoS: return FALSE; goto uEk89; aF0fR: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\x61\x69\x6c\54\40\x69\x64\54\x20\x70\x61\163\163\x77\x6f\x72\144\x2c\x20\141\143\164\x69\x76\145\54\40\154\x61\x73\164\137\x6c\157\147\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\163\x63")->get($this->tables["\x75\163\x65\162\x73"]); goto bzOM6; mQKBl: $this->clear_login_attempts($identity); goto LCe_x; xXAJA: hsMGn: goto RMrHZ; B9PYQ: $this->trigger_events("\160\157\x73\x74\137\154\x6f\x67\151\x6e\x5f\165\156\163\165\x63\143\x65\163\163\146\165\x6c"); goto r1Kmz; gZ3z2: return FALSE; goto AxLVX; uEk89: } public function recheck_session() { goto ooa0r; wFZ3R: VfMUL: goto UAIYn; wSRJP: $identity = $this->config->item("\151\x64\x65\156\x74\x69\x74\x79", "\x69\157\x6e\137\141\165\x74\x68"); goto LuViR; LuViR: $this->session->unset_userdata([$identity, "\x69\x64", "\165\163\x65\162\137\151\144"]); goto TfpLi; v5WTd: if (!($last_login + $recheck < time())) { goto UA6z0; } goto w3YKz; t1Bft: cqI8H: goto HFrH5; LbiQL: $this->trigger_events("\154\x6f\147\x6f\165\x74"); goto wSRJP; UAIYn: $this->session->set_userdata("\x6c\141\x73\164\x5f\x63\x68\145\x63\x6b", time()); goto t1Bft; w3YKz: $query = $this->db->select("\151\x64")->where([$this->identity_column => $this->session->userdata("\151\144\x65\x6e\x74\x69\164\x79"), "\x61\x63\164\151\x76\145" => "\x31"])->limit(1)->order_by("\151\x64", "\144\x65\163\143")->get($this->tables["\x75\x73\x65\x72\163"]); goto Vk5Uh; WPlNc: if (!($recheck !== 0)) { goto bm27S; } goto i2T5q; ooa0r: $recheck = NULL !== $this->config->item("\x72\x65\143\x68\145\x63\153\x5f\x74\151\x6d\145\x72", "\x69\x6f\156\137\x61\x75\164\150") ? $this->config->item("\162\145\143\x68\x65\143\x6b\x5f\x74\x69\155\x65\x72", "\x69\157\156\137\x61\165\x74\x68") : 0; goto WPlNc; aF0q2: return (bool) $this->session->userdata("\x69\x64\x65\x6e\164\151\164\171"); goto N3Nsw; r5FDL: goto cqI8H; goto wFZ3R; i2T5q: $last_login = $this->session->userdata("\x6c\141\x73\x74\x5f\x63\150\145\x63\x6b"); goto v5WTd; Ew5Lx: bm27S: goto aF0q2; TfpLi: return FALSE; goto r5FDL; Vk5Uh: if ($query->num_rows() === 1) { goto VfMUL; } goto LbiQL; HFrH5: UA6z0: goto Ew5Lx; N3Nsw: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto lKtDP; L887Y: $max_attempts = $this->config->item("\x6d\x61\170\x69\x6d\x75\155\137\x6c\x6f\147\x69\x6e\137\x61\164\164\145\x6d\x70\x74\x73", "\151\157\156\137\141\x75\164\150"); goto u5ykl; Dj1TS: GSzih: goto e4fbv; u5ykl: if (!($max_attempts > 0)) { goto GSzih; } goto GE9nP; RExyE: return $attempts >= $max_attempts; goto Dj1TS; lKtDP: if (!$this->config->item("\164\x72\141\x63\x6b\x5f\154\x6f\x67\151\156\x5f\x61\x74\x74\x65\155\160\164\163", "\151\157\x6e\137\x61\165\164\x68")) { goto G0yWf; } goto L887Y; GE9nP: $attempts = $this->get_attempts_num($identity, $ip_address); goto RExyE; NTapW: return FALSE; goto Jyi21; e4fbv: G0yWf: goto NTapW; Jyi21: } public function get_attempts_num($identity, $ip_address = NULL) { goto XR3bx; m4V3g: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto BT0g7; Eo17e: J1_0f: goto PuAdV; Mis2R: return $qres->num_rows(); goto H0fsq; yPhtX: $qres = $this->db->get($this->tables["\154\157\x67\151\156\x5f\141\164\164\145\x6d\x70\164\x73"]); goto Mis2R; PuAdV: $this->db->where("\x69\x70\137\141\x64\x64\x72\x65\x73\163", $ip_address); goto RjJYv; KSig7: $ip_address = $this->input->ip_address(); goto Eo17e; BT0g7: if (!$this->config->item("\x74\x72\x61\x63\153\137\154\x6f\x67\151\156\x5f\x69\x70\x5f\141\144\x64\x72\x65\163\163", "\151\x6f\x6e\137\141\x75\x74\x68")) { goto B2ah3; } goto rSfr6; RanuL: return 0; goto Gssxm; RjJYv: B2ah3: goto TrCoz; rSfr6: if (isset($ip_address)) { goto J1_0f; } goto KSig7; XR3bx: if (!$this->config->item("\x74\x72\x61\143\x6b\x5f\x6c\x6f\x67\151\156\x5f\141\164\164\x65\x6d\x70\x74\163", "\x69\157\156\x5f\141\x75\x74\150")) { goto MS52T; } goto MiEjc; MiEjc: $this->db->select("\61", FALSE); goto m4V3g; TrCoz: $this->db->where("\164\x69\155\x65\x20\76", time() - $this->config->item("\x6c\x6f\143\153\x6f\x75\x74\137\x74\x69\x6d\x65", "\x69\x6f\x6e\x5f\x61\x75\x74\x68"), FALSE); goto yPhtX; H0fsq: MS52T: goto RanuL; Gssxm: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto xd24T; pYGDz: yXJEX: goto Z1RzV; HOpET: mBFTi: goto fbWfy; qbJF6: if (!$this->config->item("\x74\x72\x61\143\153\x5f\x6c\157\x67\x69\156\x5f\x69\160\x5f\x61\x64\144\x72\x65\163\x73", "\151\x6f\156\137\x61\165\x74\x68")) { goto gSkBd; } goto sxuyM; Z1RzV: return 0; goto tvylj; mCBvi: if (!($qres->num_rows() > 0)) { goto eBIJY; } goto vyYbJ; Co4zJ: $this->db->select("\164\151\155\x65"); goto jED7K; RU3hh: $this->db->order_by("\x69\x64", "\x64\x65\163\x63"); goto EECPb; vyYbJ: return $qres->row()->time; goto AEkn3; A7dlk: $ip_address = $this->input->ip_address(); goto HOpET; fbWfy: $this->db->where("\x69\x70\137\x61\x64\144\x72\x65\163\163", $ip_address); goto nLNB5; jED7K: $this->db->where("\154\x6f\147\151\156", $identity); goto qbJF6; nLNB5: gSkBd: goto RU3hh; xd24T: if (!$this->config->item("\164\x72\141\x63\153\137\154\x6f\x67\151\x6e\x5f\141\x74\x74\x65\155\160\164\x73", "\x69\x6f\156\x5f\x61\165\164\150")) { goto yXJEX; } goto Co4zJ; EECPb: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\x5f\141\164\164\145\x6d\160\164\x73"], 1); goto mCBvi; sxuyM: if (isset($ip_address)) { goto mBFTi; } goto A7dlk; AEkn3: eBIJY: goto pYGDz; tvylj: } public function get_last_attempt_ip($identity) { goto TOYVQ; I_gos: $this->db->where("\x6c\157\147\x69\x6e", $identity); goto GWrjk; gU5Er: return ''; goto JJvVF; TOYVQ: if (!($this->config->item("\x74\162\141\x63\x6b\x5f\154\x6f\147\151\156\x5f\141\x74\164\x65\155\x70\164\163", "\151\157\x6e\137\141\x75\x74\x68") && $this->config->item("\164\162\x61\x63\x6b\x5f\154\157\147\151\156\137\x69\160\x5f\x61\144\x64\x72\x65\163\x73", "\151\x6f\x6e\137\x61\x75\164\150"))) { goto NzGk5; } goto XaYDJ; ZMoAW: if (!($qres->num_rows() > 0)) { goto I5qLf; } goto tIIxu; GWrjk: $this->db->order_by("\151\144", "\144\x65\x73\143"); goto VIBhm; lN_rL: NzGk5: goto gU5Er; VIBhm: $qres = $this->db->get($this->tables["\154\157\x67\x69\156\137\x61\x74\x74\145\155\160\164\x73"], 1); goto ZMoAW; XaYDJ: $this->db->select("\x69\160\137\141\x64\144\162\x65\x73\163"); goto I_gos; T6sg2: I5qLf: goto lN_rL; tIIxu: return $qres->row()->ip_address; goto T6sg2; JJvVF: } public function increase_login_attempts($identity) { goto mOQtP; FVOka: return FALSE; goto UhSof; HeWPm: $data = ["\x69\x70\x5f\141\144\144\x72\x65\163\163" => '', "\154\157\x67\x69\x6e" => $identity, "\x74\x69\x6d\145" => time()]; goto xu9zE; xu9zE: if (!$this->config->item("\164\162\141\143\x6b\x5f\x6c\x6f\x67\x69\156\x5f\151\x70\137\x61\x64\144\x72\x65\163\x73", "\x69\157\x6e\137\141\x75\164\150")) { goto JL_eG; } goto m13WS; hzeg_: ddFj9: goto FVOka; mOQtP: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\x6c\x6f\x67\151\156\137\141\164\164\145\x6d\160\x74\x73", "\151\x6f\156\x5f\x61\165\x74\150")) { goto ddFj9; } goto HeWPm; m13WS: $data["\x69\x70\x5f\x61\x64\144\162\x65\x73\163"] = $this->input->ip_address(); goto kH034; kH034: JL_eG: goto ugF7Y; ugF7Y: return $this->db->insert($this->tables["\x6c\157\x67\151\x6e\137\141\x74\164\145\x6d\x70\164\x73"], $data); goto hzeg_; UhSof: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto dSrxz; bjntT: ABfL0: goto BCLam; dSrxz: if (!$this->config->item("\164\162\x61\143\x6b\137\154\x6f\147\151\x6e\137\141\164\x74\x65\155\x70\164\163", "\151\157\x6e\x5f\141\165\164\x68")) { goto i3Rnu; } goto oT4zU; v6OMe: if (!$this->config->item("\164\162\141\143\x6b\x5f\154\157\147\x69\x6e\137\x69\160\137\x61\144\144\162\x65\163\x73", "\x69\x6f\156\x5f\141\165\164\150")) { goto ABfL0; } goto y_wSY; oBAd9: $this->db->where("\x69\160\x5f\x61\x64\144\x72\145\x73\x73", $ip_address); goto bjntT; y_wSY: if (isset($ip_address)) { goto bUNwe; } goto EZvc9; oT4zU: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\143\153\157\165\x74\x5f\x74\x69\x6d\145", "\x69\x6f\156\x5f\x61\165\164\150")); goto VEjks; VEjks: $this->db->where("\x6c\x6f\x67\151\156", $identity); goto v6OMe; TB1N2: return $this->db->delete($this->tables["\154\157\147\x69\156\x5f\x61\164\x74\145\155\160\164\x73"]); goto IS98l; tdJhf: return FALSE; goto wI6_2; IS98l: i3Rnu: goto tdJhf; ksVvh: bUNwe: goto oBAd9; BCLam: $this->db->or_where("\164\x69\x6d\145\40\x3c", time() - $old_attempts_expire_period, FALSE); goto TB1N2; EZvc9: $ip_address = $this->input->ip_address(); goto ksVvh; wI6_2: } public function limit($limit) { goto QY2Kf; QY2Kf: $this->trigger_events("\154\x69\x6d\x69\164"); goto WSlDZ; cyZZP: return $this; goto kdWQb; WSlDZ: $this->_ion_limit = $limit; goto cyZZP; kdWQb: } public function offset($offset) { goto rHFld; rHFld: $this->trigger_events("\x6f\146\146\x73\145\x74"); goto u0_pf; ItH8y: return $this; goto D0Bx0; u0_pf: $this->_ion_offset = $offset; goto ItH8y; D0Bx0: } public function where($where, $value = NULL) { goto Joh3r; Joh3r: $this->trigger_events("\167\x68\145\162\145"); goto UP5X0; UP5X0: if (is_array($where)) { goto WGLHx; } goto KCEBH; NSA2B: WGLHx: goto eARKC; eARKC: array_push($this->_ion_where, $where); goto xIGpS; KCEBH: $where = [$where => $value]; goto NSA2B; xIGpS: return $this; goto Wx77D; Wx77D: } public function like($like, $value = NULL, $position = "\142\x6f\164\150") { goto sUIJe; sUIJe: $this->trigger_events("\x6c\x69\x6b\145"); goto Jw49w; Jw49w: array_push($this->_ion_like, ["\x6c\x69\153\145" => $like, "\166\x61\154\x75\145" => $value, "\160\x6f\163\151\x74\151\157\156" => $position]); goto dmJPK; dmJPK: return $this; goto qmpGy; qmpGy: } public function select($select) { goto i0yvf; naVYf: return $this; goto MoJSL; wiULQ: $this->_ion_select[] = $select; goto naVYf; i0yvf: $this->trigger_events("\163\145\154\x65\143\x74"); goto wiULQ; MoJSL: } public function order_by($by, $order = "\144\145\163\143") { goto BqT57; KmkJa: $this->_ion_order = $order; goto Tbe_t; BqT57: $this->trigger_events("\x6f\x72\144\145\x72\137\142\x79"); goto WQX4n; Tbe_t: return $this; goto hkJ8j; WQX4n: $this->_ion_order_by = $by; goto KmkJa; hkJ8j: } public function row() { goto s9aga; s9aga: $this->trigger_events("\162\x6f\167"); goto hqaV7; hqaV7: $row = $this->response->row(); goto wKvvj; wKvvj: return $row; goto Vdpc_; Vdpc_: } public function row_array() { goto fw3Wj; kRjoh: return $row; goto YNAC7; QGRA8: $row = $this->response->row_array(); goto kRjoh; fw3Wj: $this->trigger_events(["\162\x6f\x77", "\162\x6f\x77\137\141\x72\x72\x61\x79"]); goto QGRA8; YNAC7: } public function result() { goto uXZIN; ppNHA: $result = $this->response->result(); goto dSaH8; dSaH8: return $result; goto zei76; uXZIN: $this->trigger_events("\x72\x65\163\x75\154\x74"); goto ppNHA; zei76: } public function result_array() { goto J8uUN; V_Bdq: $result = $this->response->result_array(); goto dKoRK; J8uUN: $this->trigger_events(["\x72\145\x73\165\x6c\x74", "\162\145\163\x75\x6c\x74\137\141\162\162\x61\171"]); goto V_Bdq; dKoRK: return $result; goto vQX1X; vQX1X: } public function num_rows() { goto JO59s; zNALg: $result = $this->response->num_rows(); goto hKDiK; hKDiK: return $result; goto Qq0SR; JO59s: $this->trigger_events(["\156\165\x6d\x5f\x72\x6f\x77\163"]); goto zNALg; Qq0SR: } public function users($groups = NULL) { goto uOGsu; Vxu9a: kthz7: goto c3etn; Uzv8N: $this->db->join($this->tables["\165\163\x65\x72\163\137\x67\x72\x6f\165\x70\x73"], $this->tables["\x75\163\x65\162\163\137\147\x72\157\165\160\x73"] . "\56" . $this->join["\165\163\x65\x72\x73"] . "\x3d" . $this->tables["\x75\163\x65\162\x73"] . "\x2e\151\144", "\x69\x6e\156\145\162"); goto Vxu9a; TN9Bx: $groups = [$groups]; goto E08uL; MzuxN: $group_names = []; goto Ap9AU; VXbR7: return $this; goto rirOC; N4NEo: goto JkYzE; goto G8I60; r7bor: $this->_ion_limit = NULL; goto FM1lf; SnxPn: oIdNU: goto Z38OK; IuplN: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto hIseY; } goto prrAW; LVXA3: $this->trigger_events("\145\170\164\x72\141\137\x77\150\145\x72\145"); goto IuplN; JDOO5: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto dE3RC; } goto leStU; Eho6_: goto BnDUd; goto D308o; x5VGe: $this->_ion_order_by = NULL; goto Tqj3o; zMK6W: AOqch: goto EIR5L; ezCLT: $this->db->{$or_where_in}($this->tables["\165\x73\145\x72\x73\137\x67\x72\157\165\160\x73"] . "\56" . $this->join["\x67\x72\157\165\160\x73"], $group_ids); goto VLzDN; R1gAJ: Ss1xh: goto t_Thr; Tqj3o: goE3q: goto DpKMW; Z38OK: if (empty($group_ids)) { goto aXm7y; } goto ezCLT; YsBms: k1ZML: goto Eho6_; uOGsu: $this->trigger_events("\x75\163\x65\x72\163"); goto Q6187; prrAW: foreach ($this->_ion_where as $where) { $this->db->where($where); Umf7U: } goto R1gAJ; tuA1O: JkYzE: goto L8fVq; leStU: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\x6b\145"], $like["\166\x61\154\165\x65"], $like["\x70\x6f\x73\x69\164\x69\x6f\156"]); Rsq29: } goto KMSuj; E08uL: JxkwB: goto BGFBa; mmNxR: $this->_ion_order = NULL; goto x5VGe; D308o: IAlHi: goto Ky_ui; L8fVq: if (!isset($groups)) { goto TcS3X; } goto gUKwv; Ap9AU: foreach ($groups as $group) { goto rxGD_; du9Zf: goto wHxmq; goto bZfvL; bZfvL: UJjOX: goto Q4PgX; Q4PgX: $group_ids[] = $group; goto hg807; VPm7W: AmdjT: goto J_r0M; hg807: wHxmq: goto VPm7W; rxGD_: if (is_numeric($group)) { goto UJjOX; } goto vYnM5; vYnM5: $group_names[] = $group; goto du9Zf; J_r0M: } goto wqz3i; Zf3ab: $this->db->select([$this->tables["\x75\x73\145\162\163"] . "\56\x2a", $this->tables["\x75\x73\x65\x72\x73"] . "\56\151\144\40\141\x73\40\151\144", $this->tables["\x75\163\145\x72\163"] . "\56\x69\144\40\x61\x73\x20\x75\163\145\162\x5f\x69\x64"]); goto N4NEo; Z1q1C: $this->db->distinct(); goto Uzv8N; c3etn: $group_ids = []; goto MzuxN; sNJ0W: dE3RC: goto LhjgS; G8I60: WTiQZ: goto S4zNZ; rf74M: TcS3X: goto LVXA3; Oa8Hm: $this->db->join($this->tables["\147\162\157\165\160\x73"], $this->tables["\165\x73\145\x72\x73\x5f\x67\x72\x6f\x75\x70\x73"] . "\56" . $this->join["\x67\x72\157\165\160\x73"] . "\40\75\x20" . $this->tables["\147\162\x6f\x75\160\163"] . "\x2e\x69\x64", "\x69\156\156\x65\x72"); goto JnOfW; DpKMW: $this->response = $this->db->get($this->tables["\165\x73\x65\x72\x73"]); goto VXbR7; EIR5L: $this->_ion_select = []; goto tuA1O; yc93f: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto mmNxR; Q6187: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto WTiQZ; } goto Zf3ab; c1Gql: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\167\150\x65\x72\x65\x5f\x69\156" : "\167\x68\145\162\145\137\x69\156"; goto efAZ1; KMSuj: vum0W: goto oQgwK; LhjgS: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto IAlHi; } goto ajZxa; wqz3i: PDpKL: goto c1Gql; t_Thr: $this->_ion_where = []; goto iAS6V; gUKwv: if (is_array($groups)) { goto JxkwB; } goto TN9Bx; oQgwK: $this->_ion_like = []; goto sNJ0W; ajZxa: if (!isset($this->_ion_limit)) { goto k1ZML; } goto YE4eg; S4zNZ: foreach ($this->_ion_select as $select) { $this->db->select($select); ahAm5: } goto zMK6W; FM1lf: $this->_ion_offset = NULL; goto nEpNa; V1HEW: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto goE3q; } goto yc93f; nEpNa: BnDUd: goto V1HEW; iAS6V: hIseY: goto JDOO5; VLzDN: aXm7y: goto rf74M; Dr0vM: $this->_ion_limit = NULL; goto YsBms; YE4eg: $this->db->limit($this->_ion_limit); goto Dr0vM; JnOfW: $this->db->where_in($this->tables["\x67\x72\157\165\160\163"] . "\56\x6e\x61\155\145", $group_names); goto SnxPn; BGFBa: if (!(isset($groups) && !empty($groups))) { goto kthz7; } goto Z1q1C; efAZ1: if (empty($group_names)) { goto oIdNU; } goto Oa8Hm; Ky_ui: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto r7bor; rirOC: } public function user($id = NULL) { goto IKue9; ubEhz: $this->where($this->tables["\x75\x73\x65\162\163"] . "\x2e\x69\144", $id); goto ek2Yr; YvfXb: return $this; goto s1z0M; y5nXM: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\x72\x5f\151\144"); goto TlufR; TlufR: $this->limit(1); goto Qamw_; Qamw_: $this->order_by($this->tables["\x75\163\x65\x72\x73"] . "\x2e\x69\x64", "\x64\x65\163\143"); goto ubEhz; IKue9: $this->trigger_events("\x75\163\145\162"); goto y5nXM; ek2Yr: $this->users(); goto YvfXb; s1z0M: } public function get_users_groups($id = FALSE) { goto p0KgO; CgcaA: $id || ($id = $this->session->userdata("\x75\x73\x65\162\x5f\x69\x64")); goto qJQiz; qJQiz: return $this->db->select($this->tables["\x75\x73\x65\x72\163\x5f\x67\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\147\x72\157\x75\160\x73"] . "\x20\141\x73\40\x69\x64\x2c\x20" . $this->tables["\147\162\x6f\x75\x70\x73"] . "\x2e\156\x61\155\x65\54\x20" . $this->tables["\x67\x72\157\165\x70\x73"] . "\56\x64\x65\163\x63\162\151\x70\164\151\157\x6e")->where($this->tables["\x75\x73\x65\x72\163\x5f\147\162\157\165\x70\x73"] . "\56" . $this->join["\165\163\145\162\163"], $id)->join($this->tables["\x67\x72\x6f\165\x70\x73"], $this->tables["\165\163\x65\162\x73\x5f\x67\162\157\x75\x70\x73"] . "\x2e" . $this->join["\147\x72\157\x75\x70\x73"] . "\x3d" . $this->tables["\x67\162\x6f\x75\160\x73"] . "\56\151\144")->get($this->tables["\x75\163\x65\162\x73\x5f\x67\162\157\x75\x70\x73"]); goto ubd4o; p0KgO: $this->trigger_events("\x67\145\x74\x5f\165\163\x65\x72\163\137\x67\162\x6f\x75\160"); goto CgcaA; ubd4o: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto q_NVZ; GrgBh: return $check_all; goto u5RSC; q_NVZ: $this->trigger_events("\x69\156\x5f\147\x72\x6f\165\x70"); goto VzGEL; iRfgt: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; jIdRc: } goto jILwI; kWqlw: $groups_array = []; goto iRfgt; GMi7l: foreach ($check_group as $key => $value) { goto RTO1J; w27YD: u0v4k: goto WFo9w; wU5WK: if (!(in_array($value, $groups) xor $check_all)) { goto DOjav; } goto Hfmv0; Hfmv0: return !$check_all; goto kaPU9; RTO1J: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto wU5WK; kaPU9: DOjav: goto w27YD; WFo9w: } goto F1wSi; iA7fK: $groups_array = $this->_cache_user_in_group[$id]; goto R8ndy; F1wSi: t432p: goto GrgBh; U7_UM: $users_groups = $this->get_users_groups($id)->result(); goto kWqlw; R8ndy: k2ckb: goto GMi7l; i0oy0: if (isset($this->_cache_user_in_group[$id])) { goto j2Kzf; } goto U7_UM; HS5B8: $this->_cache_user_in_group[$id] = $groups_array; goto Tnk5c; VzGEL: $id || ($id = $this->session->userdata("\165\x73\x65\x72\x5f\151\144")); goto Mzyd2; jILwI: Tf8Kb: goto HS5B8; Tnk5c: goto k2ckb; goto t_PKY; t_PKY: j2Kzf: goto iA7fK; Mzyd2: if (is_array($check_group)) { goto sWXvd; } goto vRV7q; wtDkx: sWXvd: goto i0oy0; vRV7q: $check_group = [$check_group]; goto wtDkx; u5RSC: } public function add_to_group($group_ids, $user_id = FALSE) { goto WCTzO; G9584: $user_id || ($user_id = $this->session->userdata("\165\163\145\x72\x5f\151\144")); goto VrU9O; uvYMi: g3B2q: goto Y8Zc2; Y8Zc2: $return = 0; goto o_RRP; VrU9O: if (is_array($group_ids)) { goto g3B2q; } goto hwJsC; xsqBD: return $return; goto ujNz6; hwJsC: $group_ids = [$group_ids]; goto uvYMi; WCTzO: $this->trigger_events("\141\144\x64\x5f\164\157\x5f\147\162\157\165\x70"); goto G9584; pk8A9: ePFMF: goto xsqBD; o_RRP: foreach ($group_ids as $group_id) { goto hthin; Oyfw2: r6Shr: goto HfW40; kRbGA: goto r6Shr; goto zjcIQ; rA97Q: $return++; goto Ufx92; HfW40: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto rA97Q; hb9Nz: $group_name = $this->_cache_groups[$group_id]; goto Oyfw2; BoKl8: $this->_cache_groups[$group_id] = $group_name; goto kRbGA; Ufx92: B2vcR: goto AbWzb; UYnzc: if (isset($this->_cache_groups[$group_id])) { goto k3tZY; } goto lloX7; hthin: if (!$this->db->insert($this->tables["\165\163\145\162\163\137\x67\x72\x6f\x75\x70\x73"], [$this->join["\x67\x72\157\x75\160\163"] => (float) $group_id, $this->join["\x75\x73\145\162\x73"] => (float) $user_id])) { goto B2vcR; } goto UYnzc; lloX7: $group = $this->group($group_id)->result(); goto OQHrA; AbWzb: gCg_F: goto bM3u3; zjcIQ: k3tZY: goto hb9Nz; OQHrA: $group_name = $group[0]->name; goto BoKl8; bM3u3: } goto pk8A9; ujNz6: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto ffFRt; Toj8O: $group_ids = [$group_ids]; goto ts2WZ; yEa6H: IsCL6: goto n1mXd; AwxI5: return FALSE; goto SerCK; xCy_3: if (!($return = $this->db->delete($this->tables["\165\x73\145\162\x73\x5f\147\x72\157\x75\x70\163"], [$this->join["\x75\163\x65\162\x73"] => (float) $user_id]))) { goto L3zHN; } goto Ga7mo; n1mXd: if (is_array($group_ids)) { goto GNT7a; } goto Toj8O; Ws12s: DCLVo: goto AU_Av; Ga7mo: $this->_cache_user_in_group[$user_id] = []; goto NF3Te; ZKb2v: goto DCLVo; goto yEa6H; BbSPO: foreach ($group_ids as $group_id) { goto ugZ0L; Xr6Po: H0rH4: goto Jopdj; PpWin: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto H0rH4; } goto kxQyN; ugZ0L: $this->db->delete($this->tables["\x75\x73\x65\x72\x73\137\x67\x72\157\x75\160\x73"], [$this->join["\147\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\163\145\162\x73"] => (float) $user_id]); goto PpWin; kxQyN: unset($this->_cache_user_in_group[$user_id][$group_id]); goto Xr6Po; Jopdj: GiBFu: goto hmu7f; hmu7f: } goto HtfRr; ts2WZ: GNT7a: goto BbSPO; HtfRr: jPt_j: goto HZOa9; ecMwX: if (!empty($user_id)) { goto l77cy; } goto AwxI5; AU_Av: return $return; goto AFVbK; NF3Te: L3zHN: goto ZKb2v; SerCK: l77cy: goto vX78l; vX78l: if (!empty($group_ids)) { goto IsCL6; } goto xCy_3; HZOa9: $return = TRUE; goto Ws12s; ffFRt: $this->trigger_events("\x72\145\x6d\157\x76\x65\x5f\x66\x72\157\x6d\x5f\147\x72\157\165\160"); goto ecMwX; AFVbK: } public function groups() { goto yZZGx; Hvs8_: return $this; goto yX4Pv; FtG4K: aq2CF: goto yaZeM; jMay9: IZPMT: goto xK4V7; xK4V7: $this->_ion_where = []; goto mN8ld; yZZGx: $this->trigger_events("\x67\x72\157\x75\x70\x73"); goto If3H9; yaZeM: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto oL51e; } goto jNGRU; R3b3w: ZZO8m: goto fjRY7; If3H9: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto X8aXN; } goto DnfEb; apnlS: $this->_ion_offset = NULL; goto FtG4K; jNGRU: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto Rtv_Y; IlQMa: if (!isset($this->_ion_limit)) { goto r5e_O; } goto r_FAS; r_FAS: $this->db->limit($this->_ion_limit); goto rEgl_; rN1zB: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ZZO8m; } goto IlQMa; MxRPS: $this->_ion_limit = NULL; goto apnlS; sYujt: $this->response = $this->db->get($this->tables["\147\x72\157\x75\160\x73"]); goto Hvs8_; Rtv_Y: oL51e: goto sYujt; mN8ld: X8aXN: goto rN1zB; DnfEb: foreach ($this->_ion_where as $where) { $this->db->where($where); zobSd: } goto jMay9; fjRY7: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto MxRPS; o98Z9: goto aq2CF; goto R3b3w; rEgl_: $this->_ion_limit = NULL; goto Gbhyy; Gbhyy: r5e_O: goto o98Z9; yX4Pv: } public function group($id = NULL) { goto ncijw; ncijw: $this->trigger_events("\x67\x72\157\165\x70"); goto FeR6Y; FeR6Y: if (!isset($id)) { goto ykmTu; } goto vFPFf; gd9wa: ykmTu: goto mOIuh; J4Oum: return $this->groups(); goto U4udc; mOIuh: $this->limit(1); goto AxzvS; vFPFf: $this->where($this->tables["\x67\x72\157\x75\160\163"] . "\56\x69\144", $id); goto gd9wa; AxzvS: $this->order_by("\x69\144", "\x64\145\x73\x63"); goto J4Oum; U4udc: } public function update($id, array $data) { goto efQGB; vPfdc: MPBlo: goto SUek7; Vzsug: $this->db->trans_commit(); goto qbdIv; ZHkwf: return TRUE; goto Q6l9s; gV1RM: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\163\x77\157\162\144", $data) || array_key_exists("\x65\155\141\x69\x6c", $data))) { goto UCHKr; } goto EXxwq; xMmOm: pv6HS: goto BjITr; c_Ofs: if (!($this->db->trans_status() === FALSE)) { goto bgOV1; } goto Ev2Gn; OgkpD: return FALSE; goto nw6o0; BKkAM: $this->db->update($this->tables["\x75\163\x65\x72\163"], $data, ["\x69\x64" => $user->id]); goto c_Ofs; qbdIv: $this->trigger_events(["\x70\x6f\163\x74\137\165\160\144\x61\164\x65\x5f\x75\x73\145\162", "\x70\157\163\x74\137\x75\x70\x64\141\164\145\137\x75\163\145\162\137\x73\x75\x63\x63\145\163\163\x66\165\154"]); goto MG7Br; RWxNx: goto FDiak; goto rIuCN; BrakV: unset($data["\x70\x61\x73\163\167\x6f\162\144"]); goto RWxNx; q5W6E: $this->db->trans_begin(); goto N3O6K; efQGB: $this->trigger_events("\x70\162\x65\x5f\x75\160\144\x61\164\x65\x5f\165\163\x65\x72"); goto vTVFT; fZ5CK: $this->trigger_events("\145\x78\164\162\x61\137\167\x68\x65\162\145"); goto BKkAM; rIuCN: WDXLL: goto Qzyo6; p9tUH: $this->trigger_events(["\160\x6f\163\x74\137\x75\x70\144\x61\164\x65\x5f\x75\x73\x65\162", "\160\x6f\x73\164\137\165\160\144\x61\164\x65\x5f\165\163\145\162\x5f\x75\156\x73\x75\x63\143\x65\163\x73\146\x75\x6c"]); goto GyzCm; Ml16H: $this->db->trans_rollback(); goto gQarn; CiBYx: $this->trigger_events(["\160\157\x73\x74\137\165\160\144\141\164\x65\137\165\x73\x65\162", "\x70\x6f\x73\x74\x5f\x75\160\144\x61\164\145\137\165\163\145\162\x5f\165\x6e\x73\165\x63\x63\145\163\163\146\165\154"]); goto qxQwW; BjITr: UCHKr: goto fZ5CK; rrJ2u: return FALSE; goto FIBo0; FIBo0: bgOV1: goto Vzsug; nw6o0: bG782: goto YPuKr; SUek7: FDiak: goto xMmOm; YPuKr: $data = $this->_filter_data($this->tables["\165\x73\145\162\163"], $data); goto gV1RM; f9fEs: if (!empty($data["\x70\141\163\x73\x77\157\x72\x64"])) { goto WDXLL; } goto BrakV; ZAf9N: $this->db->trans_rollback(); goto tiI_R; vTVFT: $user = $this->user($id)->row(); goto q5W6E; qxQwW: $this->set_error("\165\160\x64\x61\164\145\x5f\x75\156\x73\x75\x63\143\x65\x73\x73\x66\165\154"); goto OgkpD; gwU32: if (!($data["\160\141\x73\x73\x77\157\162\x64"] === FALSE)) { goto MPBlo; } goto Ml16H; tiI_R: $this->set_error("\x61\143\143\157\x75\x6e\x74\137\x63\x72\x65\141\x74\x69\x6f\156\137\x64\165\x70\154\151\x63\x61\164\145\137\x69\x64\145\156\x74\x69\164\171"); goto CiBYx; Qzyo6: $data["\x70\141\163\163\167\157\162\x64"] = $this->hash_password($data["\x70\141\163\163\x77\x6f\162\144"], $user->{$this->identity_column}); goto gwU32; EXxwq: if (!array_key_exists("\160\x61\163\x73\x77\x6f\162\x64", $data)) { goto pv6HS; } goto f9fEs; N3O6K: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto bG782; } goto ZAf9N; MG7Br: $this->set_message("\165\160\x64\141\x74\x65\x5f\163\165\x63\143\145\163\x73\146\x75\154"); goto ZHkwf; BwlyF: $this->set_error("\165\x70\144\141\164\x65\137\x75\156\163\165\143\143\145\163\x73\x66\x75\154"); goto P9Tao; GyzCm: $this->set_error("\x75\160\x64\141\164\145\137\x75\156\x73\x75\143\x63\x65\x73\163\146\x75\x6c"); goto rrJ2u; gQarn: $this->trigger_events(["\x70\x6f\x73\x74\137\165\x70\144\141\x74\x65\x5f\x75\x73\x65\162", "\160\157\163\164\x5f\165\x70\x64\141\x74\145\x5f\x75\163\x65\x72\137\165\x6e\163\x75\x63\x63\x65\x73\x73\146\x75\154"]); goto BwlyF; P9Tao: return FALSE; goto vPfdc; Ev2Gn: $this->db->trans_rollback(); goto p9tUH; Q6l9s: } public function delete_user($id) { goto ufSzE; UW3mW: return TRUE; goto Pv6JW; ufSzE: $this->trigger_events("\x70\x72\145\137\144\145\154\145\164\145\x5f\165\x73\x65\162"); goto N0vu5; MUADH: $this->db->delete($this->tables["\165\163\145\x72\x73"], ["\151\x64" => $id]); goto fbuj8; OrN5I: $this->trigger_events(["\x70\157\x73\164\x5f\x64\x65\154\145\164\x65\x5f\x75\163\x65\162", "\160\x6f\163\164\137\144\x65\x6c\x65\x74\145\137\165\x73\x65\x72\137\x73\165\x63\x63\145\x73\163\x66\x75\x6c"]); goto rnqGO; asUCr: return FALSE; goto wTqur; fbuj8: if (!($this->db->trans_status() === FALSE)) { goto GPBrv; } goto fafHP; fafHP: $this->db->trans_rollback(); goto KbX2l; N9nGk: $this->set_error("\x64\145\154\x65\164\145\137\165\156\x73\x75\143\x63\145\x73\163\x66\165\x6c"); goto asUCr; qVfV7: $this->db->trans_commit(); goto OrN5I; N0vu5: $this->db->trans_begin(); goto THe3i; THe3i: $this->remove_from_group(NULL, $id); goto MUADH; wTqur: GPBrv: goto qVfV7; KbX2l: $this->trigger_events(["\160\x6f\163\x74\x5f\x64\145\154\x65\164\x65\137\x75\163\145\x72", "\x70\x6f\163\x74\x5f\x64\x65\154\x65\x74\145\137\x75\x73\145\x72\137\x75\156\x73\x75\143\143\x65\x73\163\146\165\x6c"]); goto N9nGk; rnqGO: $this->set_message("\x64\145\x6c\x65\x74\x65\137\x73\x75\x63\143\x65\163\163\x66\x75\x6c"); goto UW3mW; Pv6JW: } public function update_last_login($id) { goto mTEpP; h25o5: $this->load->helper("\x64\141\164\x65"); goto vWi0d; TIckR: return $this->db->affected_rows() == 1; goto SXiQx; vWi0d: $this->trigger_events("\x65\x78\x74\x72\141\137\x77\150\145\x72\x65"); goto hC114; hC114: $this->db->update($this->tables["\165\x73\145\x72\163"], ["\x6c\141\163\164\137\154\x6f\147\151\156" => time()], ["\x69\x64" => $id]); goto TIckR; mTEpP: $this->trigger_events("\165\x70\x64\141\x74\x65\137\x6c\x61\x73\x74\137\154\x6f\147\x69\x6e"); goto h25o5; SXiQx: } public function set_lang($lang = "\145\x6e") { goto KWjEy; UFOXf: set_cookie(["\156\x61\x6d\x65" => "\x6c\x61\156\147\137\x63\x6f\x64\x65", "\x76\x61\154\x75\145" => $lang, "\145\170\160\x69\162\x65" => $expire]); goto WzWdg; tf53x: $expire = $this->config->item("\165\x73\145\x72\x5f\x65\170\x70\x69\x72\145", "\151\x6f\156\x5f\x61\x75\x74\x68"); goto TLRKA; KWjEy: $this->trigger_events("\163\x65\164\137\154\141\156\147"); goto QHdsg; rW_lC: Lkfy3: goto Apak1; QHdsg: if ($this->config->item("\165\163\x65\x72\x5f\145\x78\x70\151\162\x65", "\151\157\156\x5f\x61\x75\164\x68") === 0) { goto Lkfy3; } goto tf53x; Apak1: $expire = self::MAX_COOKIE_LIFETIME; goto kw4Df; TLRKA: goto Y_W5P; goto rW_lC; WzWdg: return TRUE; goto oNk12; kw4Df: Y_W5P: goto UFOXf; oNk12: } public function set_session($user) { goto pGW4G; e6oy8: $this->session->set_userdata($session_data); goto En1eK; Vpsqn: return TRUE; goto h4nBq; En1eK: $this->trigger_events("\160\157\x73\164\x5f\x73\145\x74\137\x73\x65\163\163\151\157\x6e"); goto Vpsqn; pGW4G: $this->trigger_events("\x70\162\145\137\x73\145\164\x5f\x73\145\x73\163\x69\157\156"); goto TV10D; TV10D: $session_data = ["\x69\144\145\156\164\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\x61\151\154" => $user->email, "\x75\163\145\162\137\151\x64" => $user->id, "\157\x6c\144\137\154\x61\x73\x74\137\154\x6f\147\151\x6e" => $user->last_login, "\x6c\141\163\x74\x5f\x63\150\x65\143\153" => time()]; goto e6oy8; h4nBq: } public function remember_user($identity) { goto h085h; gDBse: g_VmW: goto E838P; spXYe: m3vPx: goto caURp; UaACg: $expire = $this->config->item("\165\x73\x65\x72\137\145\170\160\x69\x72\145", "\151\157\156\137\x61\x75\164\x68"); goto RvawZ; fg21j: return FALSE; goto IKPyD; fSKZl: if ($identity) { goto g_VmW; } goto W0dOA; fRJX1: $expire = self::MAX_COOKIE_LIFETIME; goto IJ8B3; JbNX3: if (!$token->validator_hashed) { goto Gbeyj; } goto m72rG; IJ8B3: DiKXr: goto PqPin; m72rG: $this->db->update($this->tables["\165\163\145\x72\163"], ["\x72\145\x6d\145\155\x62\145\162\x5f\163\145\154\145\143\164\x6f\x72" => $token->selector, "\x72\145\x6d\145\x6d\x62\145\x72\x5f\x63\157\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto cnavo; VVuib: $this->trigger_events(["\160\157\x73\x74\137\x72\145\155\145\x6d\x62\145\x72\x5f\x75\x73\145\x72", "\x72\145\x6d\145\x6d\x62\x65\162\137\165\163\145\x72\x5f\x75\156\x73\165\x63\143\x65\x73\x73\x66\165\154"]); goto fg21j; caURp: Gbeyj: goto VVuib; W0dOA: return FALSE; goto gDBse; RvawZ: goto DiKXr; goto PRAOn; E838P: $token = $this->_generate_selector_validator_couple(); goto JbNX3; f3H3k: if ($this->config->item("\165\163\145\x72\x5f\145\170\x70\151\162\x65", "\x69\157\x6e\x5f\141\165\x74\x68") === 0) { goto bm3Kw; } goto UaACg; PqPin: set_cookie(["\x6e\x61\x6d\145" => $this->config->item("\162\x65\155\145\155\x62\x65\x72\137\x63\x6f\157\153\x69\x65\x5f\156\141\x6d\145", "\151\x6f\156\137\x61\x75\164\x68"), "\x76\141\x6c\165\x65" => $token->user_code, "\145\x78\160\151\162\x65" => $expire]); goto aSv1G; h085h: $this->trigger_events("\x70\162\145\x5f\x72\145\x6d\145\155\x62\x65\162\x5f\x75\x73\x65\162"); goto fSKZl; PRAOn: bm3Kw: goto fRJX1; cnavo: if (!($this->db->affected_rows() > -1)) { goto m3vPx; } goto f3H3k; twywP: return TRUE; goto spXYe; aSv1G: $this->trigger_events(["\x70\x6f\163\x74\137\162\x65\x6d\x65\155\x62\x65\162\x5f\x75\163\145\162", "\162\x65\155\145\155\x62\x65\162\137\x75\163\x65\x72\137\x73\x75\x63\143\145\163\x73\146\165\154"]); goto twywP; IKPyD: } public function login_remembered_user() { goto JKiCz; JKiCz: $this->trigger_events("\x70\162\x65\x5f\x6c\x6f\147\151\156\137\162\x65\x6d\145\x6d\142\x65\162\x65\144\137\165\x73\145\x72"); goto ktefl; MNdoL: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto qqvpf; K5M9q: $user = $query->row(); goto b16zB; Y0GTI: $this->remember_user($identity); goto Dq2nm; Vj1u0: delete_cookie($this->config->item("\x72\x65\155\145\155\142\145\x72\x5f\x63\x6f\x6f\153\151\145\x5f\x6e\141\x6d\145", "\151\x6f\156\x5f\141\165\x74\150")); goto EZUYe; wX8IU: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto xnvem; } goto zj06_; I07al: $query = $this->db->select($this->identity_column . "\54\x20\151\144\x2c\x20\145\155\x61\x69\x6c\54\40\x72\x65\155\x65\155\x62\145\162\x5f\143\157\x64\145\54\40\x6c\x61\163\164\137\154\x6f\147\x69\156")->where("\162\145\x6d\145\155\x62\145\162\137\163\x65\x6c\145\x63\164\157\x72", $token->selector)->where("\141\x63\x74\x69\x76\x65", 1)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto I4Syd; ktefl: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\x65\155\x62\145\162\137\x63\157\x6f\153\x69\145\x5f\x6e\141\155\x65", "\151\x6f\x6e\137\x61\165\164\150")); goto MNdoL; ZD7aZ: $this->trigger_events("\x65\x78\164\x72\x61\137\167\150\x65\x72\x65"); goto I07al; XvIle: return FALSE; goto l58qM; qqvpf: if (!($token === FALSE)) { goto RJ3oy; } goto typDG; I4Syd: if (!($query->num_rows() === 1)) { goto pyQGe; } goto K5M9q; TLvYZ: $this->trigger_events(["\x70\x6f\x73\x74\137\154\157\147\x69\156\137\162\x65\x6d\x65\155\142\145\x72\x65\144\x5f\165\x73\145\x72", "\x70\x6f\x73\x74\137\154\157\147\x69\x6e\x5f\x72\145\x6d\145\x6d\142\x65\162\145\x64\x5f\165\163\145\x72\x5f\163\165\143\143\145\x73\x73\x66\165\154"]); goto tHGHj; EZUYe: $this->trigger_events(["\160\157\163\164\x5f\154\157\x67\151\156\137\x72\x65\x6d\145\155\142\145\162\145\x64\137\x75\163\x65\162", "\x70\157\163\x74\x5f\x6c\157\147\x69\156\137\x72\x65\x6d\145\x6d\x62\145\x72\145\144\137\x75\163\x65\x72\137\165\156\163\x75\143\x63\x65\x73\163\146\165\x6c"]); goto XvIle; b16zB: $identity = $user->{$this->identity_column}; goto wX8IU; u2Xy3: RJ3oy: goto ZD7aZ; v9C5m: xnvem: goto UmuCQ; lVbty: if (!$this->config->item("\x75\163\145\x72\x5f\145\x78\164\145\156\144\x5f\x6f\x6e\x5f\154\x6f\147\x69\156", "\151\x6f\156\x5f\141\x75\164\x68")) { goto Ch93C; } goto Y0GTI; DhoLK: $this->clear_forgotten_password_code($identity); goto lVbty; UmuCQ: pyQGe: goto Vj1u0; Dq2nm: Ch93C: goto fRR7s; zj06_: $this->update_last_login($user->id); goto FWtJl; typDG: $this->trigger_events(["\x70\x6f\x73\x74\137\154\157\x67\151\156\x5f\162\x65\155\145\x6d\142\x65\x72\x65\144\137\165\x73\145\x72", "\160\157\x73\164\x5f\x6c\157\x67\x69\156\137\162\145\155\x65\155\x62\x65\162\145\144\137\165\163\x65\x72\x5f\x75\x6e\163\165\143\143\145\x73\x73\146\165\x6c"]); goto mQ71v; mQ71v: return FALSE; goto u2Xy3; FWtJl: $this->set_session($user); goto DhoLK; tHGHj: return TRUE; goto v9C5m; fRR7s: $this->session->sess_regenerate(FALSE); goto TLvYZ; l58qM: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto lCK8u; yleDd: lFtdX: goto Az2f1; wgprh: $this->set_error("\x67\162\x6f\165\160\x5f\141\x6c\x72\x65\x61\144\171\x5f\145\170\151\163\164\x73"); goto Am7AV; Iy1OK: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\165\x70\163"], $additional_data), $data); goto yleDd; EPS82: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\156\141\x6d\x65" => $group_name])->num_rows(); goto R8OZJ; ffLYZ: return FALSE; goto QjFGh; Am7AV: return FALSE; goto galaJ; galaJ: jp80k: goto FnN3i; Az2f1: $this->trigger_events("\x65\170\164\162\141\x5f\147\162\x6f\165\160\x5f\x73\x65\x74"); goto AAX77; ZqmC5: $group_id = $this->db->insert_id($this->tables["\147\x72\x6f\x75\160\163"] . "\137\151\144\x5f\163\x65\161"); goto Y04ws; EbT0v: if (empty($additional_data)) { goto lFtdX; } goto Iy1OK; lCK8u: if ($group_name) { goto i0dCM; } goto JlLnS; JlLnS: $this->set_error("\x67\162\x6f\x75\x70\x5f\x6e\x61\155\145\x5f\162\145\161\x75\x69\162\x65\144"); goto ffLYZ; Y04ws: $this->set_message("\147\162\157\165\x70\x5f\143\162\x65\141\x74\151\157\x6e\137\x73\x75\x63\x63\x65\x73\163\146\x75\154"); goto Wqc5S; AAX77: $this->db->insert($this->tables["\x67\x72\157\165\160\163"], $data); goto ZqmC5; FnN3i: $data = ["\156\x61\155\145" => $group_name, "\x64\x65\163\143\162\151\160\164\x69\157\x6e" => $group_description]; goto EbT0v; R8OZJ: if (!($existing_group !== 0)) { goto jp80k; } goto wgprh; QjFGh: i0dCM: goto EPS82; Wqc5S: return $group_id; goto tFWH3; tFWH3: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto T1MDa; JVXzn: $this->set_message("\147\x72\157\165\160\137\165\160\144\x61\x74\145\137\x73\x75\x63\x63\x65\x73\163\x66\x75\154"); goto NZ9Wy; u0Wa8: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto zi1e5; } goto xCo6p; xu7FT: return FALSE; goto qnYY8; jBNXp: if (empty($group_name)) { goto iRrju; } goto aMS87; KP_3X: $data["\x6e\141\155\145"] = $group_name; goto YNdGB; xDXc8: $this->set_error("\x67\162\x6f\165\160\x5f\x6e\x61\155\x65\137\141\x64\155\x69\x6e\137\x6e\x6f\x74\137\141\154\164\145\x72"); goto x6qEf; bq070: return FALSE; goto vSITp; aMS87: $existing_group = $this->db->get_where($this->tables["\147\162\157\165\x70\163"], ["\x6e\141\155\145" => $group_name])->row(); goto u0Wa8; jFipM: if (empty($additional_data)) { goto gmt9C; } goto JkE0Q; ihVGK: gmt9C: goto SwiIW; SwiIW: $this->db->update($this->tables["\147\162\157\x75\x70\x73"], $data, ["\x69\x64" => $group_id]); goto JVXzn; u9ERt: NyeYh: goto jFipM; YNdGB: iRrju: goto j9g6R; JkE0Q: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\165\160\163"], $additional_data), $data); goto ihVGK; qnYY8: oROq2: goto ttOOY; ttOOY: $data = []; goto jBNXp; x6qEf: return FALSE; goto u9ERt; fBtam: if (!($this->config->item("\x61\x64\x6d\x69\x6e\x5f\147\x72\157\x75\x70", "\151\x6f\156\x5f\x61\165\164\x68") === $group->name && $group_name !== $group->name)) { goto NyeYh; } goto xDXc8; T1MDa: if (!empty($group_id)) { goto oROq2; } goto xu7FT; xCo6p: $this->set_error("\x67\x72\157\165\160\x5f\x61\x6c\162\145\141\144\x79\137\145\170\151\163\164\163"); goto bq070; vSITp: zi1e5: goto KP_3X; j9g6R: $group = $this->db->get_where($this->tables["\x67\162\x6f\x75\x70\x73"], ["\151\144" => $group_id])->row(); goto fBtam; NZ9Wy: return TRUE; goto SOQBD; SOQBD: } public function delete_group($group_id = FALSE) { goto D2xcA; D2xcA: if (!(!$group_id || empty($group_id))) { goto UTI1D; } goto bBkw9; kYcko: if (!($group->name == $this->config->item("\141\144\155\x69\x6e\137\147\x72\157\x75\160", "\x69\x6f\156\x5f\141\165\164\150"))) { goto RDzE3; } goto S6P4n; rDWaW: $group = $this->group($group_id)->row(); goto kYcko; elxux: vqPx3: goto q_BtT; AZMjW: $this->db->trans_begin(); goto r3Muq; S6P4n: $this->trigger_events(["\160\x6f\x73\164\x5f\x64\145\154\x65\164\x65\x5f\x67\x72\x6f\x75\160", "\160\157\163\164\137\x64\x65\x6c\x65\x74\145\137\x67\x72\157\165\160\x5f\156\x6f\x74\141\x6c\x6c\157\167\145\144"]); goto uwAS1; IaUAn: return FALSE; goto C4YT0; q_BtT: $this->db->trans_commit(); goto dbAnr; CVYJu: $this->trigger_events(["\x70\x6f\x73\164\137\144\x65\x6c\x65\x74\x65\x5f\x67\x72\x6f\x75\x70", "\160\157\x73\164\137\144\145\154\x65\x74\x65\x5f\x67\x72\157\165\x70\137\165\x6e\163\x75\x63\x63\x65\163\163\x66\x75\154"]); goto eHyH_; r3Muq: $this->db->delete($this->tables["\165\163\145\162\x73\137\147\x72\x6f\165\x70\x73"], [$this->join["\147\162\157\x75\x70\x73"] => $group_id]); goto mVQwG; C4YT0: RDzE3: goto tz9Ii; eHyH_: $this->set_error("\147\162\x6f\x75\x70\x5f\x64\x65\154\x65\164\x65\x5f\165\x6e\163\x75\x63\x63\145\163\x73\x66\165\x6c"); goto clhko; cE9YA: $this->set_message("\x67\162\157\165\160\137\x64\x65\154\x65\x74\x65\x5f\163\165\x63\x63\x65\163\x73\x66\165\154"); goto omroK; omroK: return TRUE; goto g6ojb; uwAS1: $this->set_error("\x67\162\x6f\165\x70\137\x64\x65\x6c\x65\x74\145\137\x6e\157\164\x61\x6c\154\x6f\x77\x65\144"); goto IaUAn; dbAnr: $this->trigger_events(["\x70\x6f\x73\x74\x5f\144\145\154\x65\x74\145\x5f\x67\x72\x6f\x75\160", "\160\x6f\x73\164\x5f\144\x65\154\x65\164\145\137\147\x72\x6f\x75\160\x5f\163\x75\x63\x63\145\163\163\x66\165\154"]); goto cE9YA; Ldrn2: UTI1D: goto rDWaW; zMnhq: $this->db->trans_rollback(); goto CVYJu; tz9Ii: $this->trigger_events("\x70\162\145\137\144\145\x6c\145\x74\145\137\x67\x72\x6f\165\x70"); goto AZMjW; clhko: return FALSE; goto elxux; bBkw9: return FALSE; goto Ldrn2; mVQwG: $this->db->delete($this->tables["\147\x72\x6f\165\x70\163"], ["\x69\144" => $group_id]); goto iUcoA; iUcoA: if (!($this->db->trans_status() === FALSE)) { goto vqPx3; } goto zMnhq; g6ojb: } public function set_hook($event, $name, $class, $method, $arguments) { goto cacUt; i9xsZ: $this->_ion_hooks->{$event}[$name]->class = $class; goto wyeLq; xZv3P: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto Mv0wJ; cacUt: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto i9xsZ; wyeLq: $this->_ion_hooks->{$event}[$name]->method = $method; goto xZv3P; Mv0wJ: } public function remove_hook($event, $name) { goto YkbrL; YkbrL: if (!isset($this->_ion_hooks->{$event}[$name])) { goto w8UZR; } goto eSKHw; o1gp6: w8UZR: goto DRRH9; eSKHw: unset($this->_ion_hooks->{$event}[$name]); goto o1gp6; DRRH9: } public function remove_hooks($event) { goto zQJsf; u8LfE: kHigI: goto erbSe; tGPPE: unset($this->_ion_hooks->{$event}); goto u8LfE; zQJsf: if (!isset($this->_ion_hooks->{$event})) { goto kHigI; } goto tGPPE; erbSe: } protected function _call_hook($event, $name) { goto LQFiq; XkWkN: hWUl5: goto TLjQ6; g1CkL: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto XkWkN; IiBfv: $hook = $this->_ion_hooks->{$event}[$name]; goto g1CkL; TLjQ6: return FALSE; goto RlTIw; LQFiq: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto hWUl5; } goto IiBfv; RlTIw: } public function trigger_events($events) { goto gDvRv; I5cBY: WCKJh: goto FWiu4; tlYtG: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto WCKJh; } goto Wwqgv; FWiu4: goto cuVMT; goto nXxyk; eAMeM: sZbr7: goto kQkpr; MIuJV: W9srk: goto I5cBY; nXxyk: u6JYx: goto oy1Of; oy1Of: foreach ($events as $event) { $this->trigger_events($event); FXhNZ: } goto eAMeM; kQkpr: cuVMT: goto B8S96; Wwqgv: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); N67tl: } goto MIuJV; gDvRv: if (is_array($events) && !empty($events)) { goto u6JYx; } goto tlYtG; B8S96: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto X5IpJ; dqQHD: return TRUE; goto vX2Xb; ExPLJ: $this->message_end_delimiter = $end_delimiter; goto dqQHD; X5IpJ: $this->message_start_delimiter = $start_delimiter; goto ExPLJ; vX2Xb: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto fkFuT; ojrMW: return TRUE; goto kRkd7; MSCU0: $this->error_end_delimiter = $end_delimiter; goto ojrMW; fkFuT: $this->error_start_delimiter = $start_delimiter; goto MSCU0; kRkd7: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto AQQEC; TbO0F: foreach ($this->messages as $message) { goto sir2g; sir2g: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto gSRHC; DfRAC: RIGpm: goto s7zSc; gSRHC: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto DfRAC; s7zSc: } goto Bs30G; j41Lr: return $_output; goto zIOWu; Bs30G: ScMVz: goto j41Lr; AQQEC: $_output = ''; goto TbO0F; zIOWu: } public function messages_array($langify = TRUE) { goto sdBHV; FSH0G: return $_output; goto iuJ1E; oe2XL: goto BdlAs; goto hEuRy; sdBHV: if ($langify) { goto J9C_2; } goto kYm0v; kYm0v: return $this->messages; goto oe2XL; svdsJ: $_output = []; goto kYgA7; kYgA7: foreach ($this->messages as $message) { goto JDNMO; pHx0z: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto aujf0; JDNMO: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\43\43"; goto pHx0z; aujf0: kYQ2p: goto tqTpC; tqTpC: } goto cXt5N; cXt5N: yenBt: goto FSH0G; iuJ1E: BdlAs: goto piuHN; hEuRy: J9C_2: goto svdsJ; piuHN: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto DV2K0; rc8iV: foreach ($this->errors as $error) { goto bhoVF; Q3Xgz: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto EovB0; bhoVF: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto Q3Xgz; EovB0: LPt_7: goto JsPnZ; JsPnZ: } goto kO0ce; l2Joq: return $_output; goto v1vSU; kO0ce: lMCIg: goto l2Joq; DV2K0: $_output = ''; goto rc8iV; v1vSU: } public function errors_array($langify = TRUE) { goto rlmj2; Np2K5: J4psZ: goto j73bb; rlmj2: if ($langify) { goto J4psZ; } goto VS0D4; nJ5RA: foreach ($this->errors as $error) { goto ZAzs0; ZAzs0: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto L5jIq; qtQCO: z54QG: goto ybjCd; L5jIq: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto qtQCO; ybjCd: } goto WjrK1; zzmRH: qxA8G: goto Pj8dH; VS0D4: return $this->errors; goto eGfDv; zl_YS: return $_output; goto zzmRH; eGfDv: goto qxA8G; goto Np2K5; j73bb: $_output = []; goto nJ5RA; WjrK1: HefyV: goto zl_YS; Pj8dH: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto R3CRE; QUN5V: if (!($hash === FALSE)) { goto H93qh; } goto fesYs; fDaqG: $data = ["\x70\x61\163\163\x77\157\162\x64" => $hash, "\x72\x65\x6d\x65\x6d\x62\145\x72\x5f\143\157\x64\x65" => NULL, "\146\x6f\162\x67\x6f\x74\164\x65\x6e\x5f\x70\141\163\163\167\x6f\162\144\x5f\143\x6f\144\145" => NULL, "\146\157\162\x67\x6f\164\164\145\156\x5f\160\141\163\163\x77\x6f\162\144\137\164\x69\155\x65" => NULL]; goto p_ogS; fs1bK: H93qh: goto fDaqG; fesYs: return FALSE; goto fs1bK; A1U4M: $this->db->update($this->tables["\165\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto MuDje; MuDje: return $this->db->affected_rows() == 1; goto mVVy1; R3CRE: $hash = $this->hash_password($password, $identity); goto QUN5V; p_ogS: $this->trigger_events("\x65\x78\164\162\141\x5f\x77\150\x65\x72\x65"); goto A1U4M; mVVy1: } protected function _filter_data($table, $data) { goto TDRtx; hdAiQ: $columns = $this->db->list_fields($table); goto BrQ9t; BrQ9t: if (!is_array($data)) { goto M3tmB; } goto lB46U; KTP0s: P4BDO: goto nTiV9; X0BjT: return $filtered_data; goto FNUb7; lB46U: foreach ($columns as $column) { goto kqLIV; Y1wy4: ZWp0h: goto JXtpv; hYab_: $filtered_data[$column] = $data[$column]; goto bUH3l; kqLIV: if (!array_key_exists($column, $data)) { goto ihMxE; } goto hYab_; bUH3l: ihMxE: goto Y1wy4; JXtpv: } goto KTP0s; nTiV9: M3tmB: goto X0BjT; TDRtx: $filtered_data = []; goto hdAiQ; FNUb7: } protected function _random_token($result_length = 32) { goto OBo_j; fQenn: return FALSE; goto sy1aC; GTGHc: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto FXIum; FXIum: WJibB: goto rGUPA; ZgZa7: if (!function_exists("\x6d\x63\x72\171\x70\164\x5f\143\162\x65\141\164\145\137\151\166")) { goto WJibB; } goto GTGHc; N4W_Y: if (!function_exists("\162\141\x6e\x64\157\x6d\137\142\171\164\145\163")) { goto MqnGg; } goto jOmib; OBo_j: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto qDIyr; } goto WkYRh; YNEJz: MqnGg: goto ZgZa7; f0Xym: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto iu_Z8; rGUPA: if (!function_exists("\x6f\160\145\156\x73\163\154\x5f\162\x61\x6e\x64\x6f\x6d\137\160\x73\x65\x75\x64\x6f\x5f\142\171\164\x65\163")) { goto StT1g; } goto f0Xym; WkYRh: $result_length = 32; goto oeRcx; iu_Z8: StT1g: goto fQenn; oeRcx: qDIyr: goto N4W_Y; jOmib: return bin2hex(random_bytes($result_length / 2)); goto YNEJz; sy1aC: } protected function _get_hash_parameters($identity = NULL) { goto PZP0p; wdwgC: switch ($this->hash_method) { case "\x62\143\x72\x79\160\x74": $params = ["\x63\157\x73\164" => $is_admin ? $this->config->item("\142\143\x72\x79\160\164\x5f\141\x64\155\151\156\137\143\157\163\x74", "\x69\157\x6e\x5f\141\165\164\150") : $this->config->item("\x62\143\162\x79\160\164\137\x64\x65\146\x61\x75\154\x74\137\x63\x6f\x73\x74", "\151\x6f\156\137\x61\165\164\150")]; goto fIRkY; case "\141\162\147\x6f\156\62": $params = $is_admin ? $this->config->item("\x61\x72\147\x6f\x6e\x32\137\x61\x64\155\151\x6e\x5f\x70\141\x72\141\155\163", "\151\157\156\137\x61\165\164\150") : $this->config->item("\x61\x72\147\x6f\156\x32\137\144\x65\146\x61\165\154\164\137\x70\x61\x72\141\x6d\x73", "\151\157\156\x5f\x61\165\164\150"); goto fIRkY; default: } goto jsQBh; ar354: if (!($user_id && $this->in_group($this->config->item("\x61\x64\155\151\156\137\x67\162\x6f\x75\160", "\151\157\156\137\141\165\164\150"), $user_id))) { goto sQhsK; } goto P4ElS; yuI2C: $user_id = $this->get_user_id_from_identity($identity); goto ar354; jsQBh: RHYKn: goto HNLks; PZP0p: $is_admin = FALSE; goto c69aK; P4ElS: $is_admin = TRUE; goto m6Ep3; KOEN5: return $params; goto vZ17z; m6Ep3: sQhsK: goto f4zyS; LeScO: $params = FALSE; goto wdwgC; f4zyS: zrtPL: goto LeScO; HNLks: fIRkY: goto KOEN5; c69aK: if (!$identity) { goto zrtPL; } goto yuI2C; vZ17z: } protected function _get_hash_algo() { goto j38fR; j38fR: $algo = FALSE; goto zuWy1; GuTGP: c7b4H: goto o0kwg; zuWy1: switch ($this->hash_method) { case "\142\x63\162\171\160\164": $algo = PASSWORD_BCRYPT; goto xUnHQ; case "\141\x72\x67\157\156\x32": $algo = PASSWORD_ARGON2I; goto xUnHQ; default: } goto GuTGP; o0kwg: xUnHQ: goto J12Rm; J12Rm: return $algo; goto WDy1b; WDy1b: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto Oh0MB; VKI8e: $validator_hashed = $this->hash_password($validator); goto BbfUA; lpOsp: return (object) ["\163\x65\x6c\x65\143\x74\x6f\162" => $selector, "\x76\x61\154\151\x64\x61\164\x6f\162\137\x68\x61\163\150\x65\144" => $validator_hashed, "\x75\x73\x65\162\137\x63\157\144\x65" => $user_code]; goto E9_gP; BbfUA: $user_code = "{$selector}\x2e{$validator}"; goto lpOsp; eyUWu: $validator = $this->_random_token($validator_size); goto VKI8e; Oh0MB: $selector = $this->_random_token($selector_size); goto eyUWu; E9_gP: } protected function _retrieve_selector_validator_couple($user_code) { goto HnCH3; HnCH3: if (!$user_code) { goto dkTDp; } goto vivCV; aidkJ: if (!(count($tokens) === 2)) { goto Rf3yn; } goto f2_a_; JsUGh: return FALSE; goto zVeCs; MYI9U: Rf3yn: goto RaF6u; f2_a_: return (object) ["\163\145\x6c\145\143\164\157\x72" => $tokens[0], "\x76\x61\154\x69\144\141\x74\157\162" => $tokens[1]]; goto MYI9U; RaF6u: dkTDp: goto JsUGh; vivCV: $tokens = explode("\56", $user_code); goto aidkJ; zVeCs: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto chFBj; ROvrg: goto YLF3o; goto lAd3Z; vjCpF: if ($salt_length) { goto JKc9c; } goto FGJN4; QXu9J: if (!($query->num_rows() !== 1)) { goto HjRAv; } goto kaPHj; lVVne: $result = $this->_set_password_db($identity, $password); goto iP3nL; j50TO: wPN1G: goto lVVne; chFBj: $this->trigger_events("\160\x72\x65\137\163\150\141\x31\137\x70\x61\163\x73\167\157\x72\x64\137\155\151\x67\162\141\x74\x69\x6f\x6e"); goto aQrZC; Adu6_: return $result; goto wiwJf; OF47q: $this->trigger_events(["\160\x6f\163\164\x5f\x73\x68\x61\x31\x5f\160\x61\x73\x73\x77\157\162\x64\137\155\x69\x67\162\x61\x74\x69\157\x6e", "\x70\x6f\x73\164\137\x73\x68\141\61\x5f\x70\x61\x73\163\x77\x6f\162\x64\137\155\151\x67\x72\x61\164\x69\x6f\x6e\x5f\163\165\143\x63\145\163\163\146\165\x6c"]); goto PpjBs; WFVkZ: aUIt6: goto BMtH0; lAd3Z: tbRjE: goto OF47q; wiwJf: t1kuC: goto iWDhE; yVeGf: return FALSE; goto Enola; yNty7: $this->trigger_events(["\x70\x6f\163\x74\137\163\x68\x61\61\x5f\160\x61\x73\163\x77\157\x72\144\x5f\x6d\151\147\x72\x61\164\x69\x6f\x6e", "\x70\157\x73\164\x5f\x73\x68\x61\61\137\160\141\163\163\167\x6f\162\x64\137\155\x69\147\x72\x61\164\x69\157\156\137\x75\x6e\163\x75\143\143\145\x73\163\146\x75\x6c"]); goto ROvrg; o4MHN: return FALSE; goto zxDPk; pE_Z7: return FALSE; goto bRwGD; PpjBs: YLF3o: goto Adu6_; BMtH0: $query = $this->db->select("\x73\141\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\x73"]); goto JyhTy; AQ03y: $salt = substr($hashed_password_db, 0, $salt_length); goto WUKWD; JyhTy: $salt_db = $query->row(); goto QXu9J; Enola: goto t1kuC; goto j50TO; zxDPk: JKc9c: goto AQ03y; z_rAy: $hashed_password = sha1($password . $salt_db->salt); goto QdgU0; HVOdS: $salt_length = $this->config->item("\163\141\154\164\137\154\145\x6e\147\x74\x68", "\151\x6f\x6e\x5f\141\x75\x74\150"); goto vjCpF; kaPHj: $this->trigger_events(["\x70\x6f\163\164\137\x73\x68\141\61\137\160\x61\163\163\167\x6f\x72\x64\x5f\155\151\x67\162\141\x74\x69\157\x6e", "\160\x6f\x73\x74\137\163\150\141\x31\x5f\x70\x61\x73\x73\167\x6f\x72\x64\x5f\x6d\x69\147\x72\141\164\151\x6f\156\x5f\165\x6e\163\165\x63\x63\145\x73\163\x66\x75\154"]); goto pE_Z7; QdgU0: SADwh: goto jSG2m; fhO5o: goto SADwh; goto WFVkZ; WUKWD: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto fhO5o; FGJN4: $this->trigger_events(["\x70\x6f\x73\164\137\163\x68\141\x31\x5f\160\141\x73\x73\167\157\162\144\137\155\151\x67\x72\x61\164\x69\x6f\156", "\160\157\163\164\137\x73\x68\141\61\137\x70\x61\163\x73\167\157\162\x64\x5f\x6d\151\147\x72\x61\164\x69\157\156\137\165\156\x73\x75\143\143\x65\x73\x73\x66\x75\x6c"]); goto o4MHN; Y0M36: $this->trigger_events(["\160\x6f\x73\x74\x5f\x73\x68\141\61\x5f\x70\x61\x73\163\x77\157\162\144\x5f\155\151\x67\162\x61\x74\151\x6f\156", "\160\157\163\x74\137\163\x68\141\x31\137\160\141\x73\x73\167\x6f\162\144\137\155\x69\147\162\141\x74\x69\157\x6e\137\x75\x6e\x73\x75\x63\143\145\x73\163\146\x75\x6c"]); goto yVeGf; iP3nL: if ($result) { goto tbRjE; } goto yNty7; aQrZC: if ($this->config->item("\163\x74\157\x72\x65\137\163\x61\x6c\164", "\x69\x6f\156\x5f\141\165\x74\150")) { goto aUIt6; } goto HVOdS; jSG2m: if ($hashed_password === $hashed_password_db) { goto wPN1G; } goto Y0M36; bRwGD: HjRAv: goto z_rAy; iWDhE: } }
